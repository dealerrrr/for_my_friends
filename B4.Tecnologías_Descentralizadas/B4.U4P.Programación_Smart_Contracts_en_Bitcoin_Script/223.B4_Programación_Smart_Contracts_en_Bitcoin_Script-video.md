---
title: 
URL: 
Tags/Keywords: # # # # #
lang: es-AR
---
# titulo
![[223.B4_Programación_Smart_Contracts_en_Bitcoin_Script.mp4]]
[Titulo](URL)

Saludos, en este video les explicaremos uno de los pilares fundamentales que permiten que Bitcoin sea lo que llamamos dinero digital programable. Esto es posible gracias a Bitcoin Script, un sistema de scripting que permite a Bitcoin programar de forma interna las operaciones que se realizan dentro de su red blockchain, así como en la red de nodos que forman parte de esta red conocida como Bitcoin.

Bitcoin Script es un lenguaje de programación bastante sencillo; es muy pequeño en sus aspectos y en lo que puedes hacer con él, pero tiene una funcionalidad muy relevante: permite a los programadores de la red Bitcoin y a los usuarios transferir valor de forma completamente digital y programable entre los diferentes pares que están dentro de la red. No solo eso, Bitcoin Script es lo que hace posible que mis transferencias, o las transferencias que hagamos dentro de la red, lleguen desde el punto A al punto B de forma segura, y que solo las personas autorizadas en medio de esa transacción puedan utilizar el valor que se está transmitiendo.

¿Cómo hace esto posible Bitcoin Script? Pues bien, Bitcoin Script utiliza el poder de la criptografía junto con el de la programación para habilitar a los usuarios de la red en el uso de las diferentes transacciones que se realizan. Por ejemplo, si yo como usuario transmito dinero utilizando mis entradas de Bitcoin a otra persona, genero un script específico que me permite desbloquear mis entradas y enviarlas a esa segunda persona, quien a su vez podrá utilizar sus propios scripts para realizar este pago o los pagos subsecuentes que desee hacer después de recibir el dinero.

Por supuesto, todo esto que estoy diciendo pasa completamente desapercibido, ya que se realiza de forma transparente para el usuario. La idea de Bitcoin Script es que los programadores de Bitcoin puedan habilitar opciones de transacciones digitales completamente nuevas para la red, y que esto sea transparente para los usuarios, porque lo único que importa en este punto es que puedan realizar sus operaciones sin mayores inconvenientes.

Ahora bien, Bitcoin Script es normalmente conocido como un lenguaje del tipo stack o de pila. Es decir, las operaciones que se realizan con Bitcoin Script se apilan unas sobre otras y luego se ejecutan para tener una entrada de datos y una salida de la misma. Esto facilita la generación de nodos que puedan interpretar toda esta información de forma universal y que todos los nodos tengan un consenso sobre si una transacción es válida o no. Para ello, Bitcoin Script se vale de una serie de instrucciones conocidas como opcodes o códigos de operación. En la página oficial de Bitcoin, podemos ver cuáles son estos opcodes.

Los opcodes nos permiten introducir datos dentro de Bitcoin Script para que sean validados o ejecutados por los diferentes nodos. Este es un punto muy importante que quiero enfatizar: al igual que en Ethereum, donde programamos algo en Solidity y la Ethereum Virtual Machine procesa esa información, en Bitcoin ocurre algo similar, pero a un nivel mucho más sencillo. En Bitcoin no tenemos una máquina virtual como tal, sino un ejecutor que toma el Bitcoin Script, realiza las operaciones solicitadas y determina si la operación es válida para incluirla en los bloques.

Ahora bien, ¿qué operaciones podemos realizar dentro de Bitcoin Script? En la página podemos ver la anotación que tenemos disponible. Varios de estos códigos han sido desactivados por los desarrolladores de Bitcoin debido a problemas de seguridad. La idea es mantener Bitcoin Script lo más sencillo y seguro posible. Entre las operaciones que podemos realizar, encontramos los siguientes opcodes y sus capacidades. Por ejemplo, en la parte de constantes, podemos definir constantes con palabras como OP_0 o OP_FALSE, que nos permiten identificar un arreglo de datos vacíos dentro de la pila de ejecución de Bitcoin Script.

También tenemos operaciones especiales como OP_PUSH_DATA, que indican que debemos añadir una determinada cantidad de datos a la pila, dependiendo de una entrada que le otorguemos. Además, contamos con operaciones que nos permiten hacer control de flujo. Esto es importante porque, aunque Bitcoin Script es un lenguaje de scripting limitado en sus funciones, no le quita la capacidad de tener control de flujo, es decir, la capacidad de decidir si se realiza una iteración o no, dependiendo de ciertas condiciones.

Para ello, tenemos códigos como OP_NOP, que no realiza ninguna acción; OP_IF, que ejecuta una determinada acción si se cumple una condición; OP_NOTIF, que actúa si no se cumple una condición; y OP_ELSE, que es otra opción de control de flujo bastante utilizada. También existen otros opcodes como OP_VERIFY, que verifica una operación, y OP_RETURN, que marca una situación como inválida y se utiliza en muchas operaciones como base para realizar las transacciones de Coinbase.

El control de la pila también incluye varias operaciones, como duplicar la pila, abrir el stack y eliminar una instrucción. Para eliminar una instrucción se utiliza el opcode OP_DROP, y para duplicar se utiliza el opcode OP_DUP. Así, tenemos una serie de operaciones que nos permiten manejar diferentes funciones dentro de Bitcoin Script.

Un apunte importante es que, siendo Bitcoin un dinero programable, existe la capacidad de realizar operaciones aritméticas. Sumar, restar y multiplicar son operaciones posibles utilizando Bitcoin Script. Para ello, contamos con varios opcodes que permiten realizar estas operaciones. Sin embargo, es importante mencionar que los opcodes de multiplicación y división están desactivados debido a un problema que se descubrió en Bitcoin, que permitía a ciertos usuarios manipular estos opcodes para realizar operaciones mal formadas que eran validadas por el nodo, permitiéndoles obtener ingresos de forma maliciosa.

Además, hay varios opcodes desactivados por razones de seguridad. También contamos con opcodes para operaciones aritméticas, como verificar si un número es igual a otro, o si es menor o mayor. En un principio, mencioné que con Bitcoin Script se pueden realizar operaciones criptográficas. Esto tiene sentido, ya que la manera en que verificamos operaciones dentro de Bitcoin utiliza la criptografía. Para ello, Bitcoin Script tiene funciones y códigos de operación disponibles, como RIPEMD-160, SHA-1 y SHA-256, que son utilizados para generar diferentes hashes especiales para Bitcoin.

También existen operaciones de bloqueo por tiempo, como OP_CHECK_LOCKTIME_VERIFY (CLTV), que permite bloquear determinadas cantidades de criptomonedas por un tiempo hasta que se cumplan ciertas condiciones. Asimismo, tenemos OP_CHECKSEQUENCEVERIFY (CSV), que tiene funciones similares a CLTV, pero utiliza un sistema de secuencias en lugar de un bloqueo temporal.

Ahora que conocemos un poco sobre las operaciones dentro de Bitcoin Script y sus diferentes opcodes, recomiendo leer y familiarizarse con esta página si deseas adentrarte en el mundo de la programación de Bitcoin. Sin embargo, no es la única manera de hacerlo; puedes utilizar wrappers como Python o BTC, que permiten programar operaciones en Python, pero que luego son traducidas a los opcodes necesarios para generar transacciones que puedan ser entendidas por la red Bitcoin.

Esta lista de operaciones de opcodes nos indica que podemos programar operaciones de diversas índoles con Bitcoin Script. Esto elimina la idea de que Bitcoin Script no tiene la capacidad de programar smart contracts. De hecho, cada vez que realizas una transacción en Bitcoin, las operaciones de distintas índoles se pueden programar en el mismo sistema. Esto es lo que permite programar una transacción en Bitcoin Script, y es posible gracias a un pequeño smart contract dentro de esa operación, ya que Bitcoin Script es un lenguaje de tipo smart contract.

La diferencia entre los smart contracts de Ethereum y los de Bitcoin es que los smart contracts de Bitcoin no son Turing completos. Esto significa que no podemos crear estructuras extremadamente complejas en comparación con lo que podemos hacer con Solidity. Por ejemplo, no podríamos crear un oráculo blockchain como Chainlink sobre Bitcoin, porque no hay capacidad para este tipo de operaciones. Sin embargo, los desarrolladores de Bitcoin entienden que estas limitaciones deben ser superadas, y para ello se han creado diferentes sistemas, como Miniscript y wrappers para Python u otros lenguajes de programación.

Estos wrappers y extensiones buscan llevar a Bitcoin a más lugares para potenciar su uso. Para ver cómo funciona Bitcoin Script en realidad, vamos a mostrar algunos ejemplos en pantalla para que vean cómo es la programación de un Bitcoin Script y hasta dónde se puede llevar este potencial.

Voy a mostrar el primer ejemplo. En este caso, tenemos un comando llamado BTCd, que contiene una serie de datos que iré demostrando. Este primer dato es nuestra firma de Bitcoin. Luego viene la firma hash y aquí están nuestras operaciones. Esta línea que estoy recorriendo es una dirección de Bitcoin que pueden verificar directamente en un mempool. Aquí están nuestras operaciones completas.

Lo que vemos aquí arriba pertenece a nuestro script de verificación. Este script contiene la información de nuestra clave pública y la firma correspondiente para movilizar una determinada cantidad de criptomonedas dentro de una dirección. En este caso, la dirección que estamos viendo es la 12AB8. Esto le indica a Bitcoin Script que tenemos esta dirección, esta firma y estos scripts. Vamos a ejecutar estos scripts dentro de un nodo y verificar si todo es correcto. Si es así, esta persona podrá movilizar el dinero que está en esa dirección.

El primer cuerpo que tenemos aquí son las dos primeras líneas, que serían nuestro script de verificación. Luego viene el script como tal. Primero duplicamos la pila, que tomará esta información y la duplicará. Luego hacemos un hash 160, es decir, realizamos un hash RIPEMD-160 y SHA-256. Después, verificamos si la dirección es igual y luego verificamos las firmas.

Para ejecutar este Bitcoin Script y verlo gráficamente, vamos a limpiar la pantalla y ejecutar un depurador llamado BTCDEP. Este es un depurador oficial de Bitcoin Script que pueden utilizar con confianza. Ahora que sabemos dónde conseguir la herramienta BTCDEP, vamos a ejecutar un pequeño script con un ejemplo de transacción que ya hemos modificado.

Aquí tenemos el script cargado. Vamos a ir ejecutando paso a paso cada una de estas operaciones. El primer paso es duplicar la pila superior. Ya está duplicada. Seguimos con el segundo paso, y la pila se sigue reduciendo mientras ejecutamos el script. Luego duplicamos nuevamente la línea anterior y aquí tenemos el script duplicado.

A continuación, aplicamos OP_HASH160. Lo que sucederá es que tomaremos la firma pública y la transformaremos en una dirección de Bitcoin, que debería ser igual a la dirección 12AB8 que estamos viendo. Ejecutamos el siguiente paso y efectivamente, en el lado del script tenemos nuestra dirección, 12AB8, y en el lado del stack ejecutándose dentro de BTCDEP, tenemos la misma dirección. Esto confirma que la firma que estamos utilizando es correcta.

El siguiente paso es enviar la firma que nos da el script. Ahora verificamos las dos firmas con OP_EQUALVERIFY. El siguiente paso se ejecuta y efectivamente, las operaciones son correctas. El script nos indica que las direcciones son idénticas, lo que nos permite continuar con la operación. Finalmente, verificamos si la firma es correcta y pertenece a quien dice pertenecer. Al aplicar el siguiente paso, confirmamos que la firma es idéntica y pertenece a quien corresponde.

Con esto, hemos terminado la ejecución de nuestro primer Bitcoin Script. Este proceso que acabo de explicar de forma gráfica con BTCDEP es el mismo que se realiza repetidamente con cada operación dentro de Bitcoin. Cada vez que un minero genera un bloque e incluye 1,000 o 1,200 transacciones, los nodos realizan estas operaciones una y otra vez hasta verificar que todo esté correcto. Luego de verificar, ingresan el bloque en la blockchain, validándolo y generando consenso en la red.

Este proceso se repite constantemente dentro de Bitcoin y otras monedas que funcionan con un esquema similar, como Dash, Zcash o Monero, que también tienen sistemas parecidos, aunque con adaptaciones. Si salimos aquí, podemos cerrar y hemos terminado con el primer ejemplo. Ahora, veamos un segundo ejemplo que he preparado.

En este caso, el ejemplo 02 presenta operaciones nuevas. Vamos a dividir un poco el script para hacerlo más legible y explicar cada una de estas operaciones. Aquí tenemos los op_DUP, OP_PUSH, PUSHBYTE y un tema de dirección y hash. Lo que ven en pantalla es una transacción del tipo SetWitness, que es común en la actualidad dentro de la red, ya que la mayoría de las transacciones son de tipo SetWitness o P2SH, que son muy similares.

El script comienza con un PUSHBYTE de 72 y un PUSHBYTE de 65, y al final nos da una clave pública. Luego, se nos pide duplicar la pila, hacer un hash 160 y luego un PUSHBYTE de 20, es decir, tomamos los últimos 20 bytes y verificamos si son idénticos a lo que tenemos en la pila. Así funciona SetWitness. Aquí, como se puede ver, nos falta la formación de las claves, ya que SetWitness divide la información en dos partes: las claves van por un lado, en lo que llamamos el witness o testigo, y la información de la transacción va por el otro.

Vamos a ejecutar este ejemplo. Aquí tenemos nuestro stack cargado. Hay algunas advertencias debido a que el BTC no está completamente sincronizado con los operadores de código de Bitcoin Script, pero podemos obviarlas y seguir adelante. Hacemos el primer paso y cargamos la primera parte del stack. Luego, seguimos cargando el siguiente paso y comenzamos las operaciones de manipulación y verificación.

Primero, realizamos una duplicación y efectivamente, ya está hecha. Luego, hacemos el hash 160 y aquí está nuestro hash de la operación anterior. Continuamos con el siguiente paso, que es hacer el PUSHBYTE y finalmente cargamos la información de la firma y hacemos la verificación. Efectivamente, la firma es correcta, lo que significa que la operación SetWitness que acabamos de ver es válida.

Dentro del script de esta operación SetWitness, todas las operaciones son correctas. Como pueden ver, es bastante sencillo utilizar BTCDEP para programar este tipo de cuestiones. Pueden ser transacciones que hayan sacado de las operaciones en el mempool o de las operaciones dentro de Bitcoin. Por ejemplo, aquí podemos ver una transacción y, si vamos a los detalles, podemos ver toda la información necesaria.

Simplemente tomaríamos esta información, la colocaríamos dentro de BTCDEP y verificaríamos si efectivamente este script, que en este caso es una operación SetWitness y de tipo multifirma, es correcto. También podemos ir paso a paso, que sería lo ideal. Si quiero hacer algo sencillo, como una suma, podríamos escribir BTCDEP OP_1, OP_2, OP_ADD. Así tendríamos nuestro primer stack con el número 1, el número 2 y el OP_ADD. Simplemente pasamos paso a paso y tenemos nuestra operación de suma.

La capacidad de Bitcoin Script para permitirnos programar es amplia, aunque no llega a los niveles de Solidity u otros lenguajes de programación de smart contracts Turing completos. Sin embargo, Bitcoin Script nos permite hacer muchas cosas increíbles a nivel de programación descentralizada. Quiero mostrarles parte de ese poder. Vamos a un proyecto que utiliza Bitcoin Script para realizar un mercado de intercambio, un DEX, un exchange descentralizado. Este es Bisq.

Bisq es un exchange descentralizado que funciona dentro de Bitcoin. Cuando instalas Bisq, realmente estás instalando un nodo de Bitcoin que opera de forma completamente descentralizada. No tiene intermediarios ni funciona con un servidor web como otros servicios descentralizados, como Uniswap. No necesitas intermediarios como Infura en el caso de Uniswap y su wallet MetaMask. Simplemente descargas este software, instalas tu propio nodo y te conectas directamente a un exchange descentralizado donde puedes intercambiar cualquier tipo de moneda.

Este es un ejemplo del potencial que existe detrás de Bitcoin Script. No solo se utiliza para programar operaciones sencillas, sino también para crear aplicaciones más complejas que se apoyan en otras tecnologías para complementar y realizar operaciones. Esto permite crear aplicaciones completamente descentralizadas que no tienen nada que envidiar a otras plataformas como Ethereum, Polkadot o cualquier otro tipo de plataforma web 3.

La web 3 y el corazón de este MBA demuestran que el mundo tal como lo conocemos puede descentralizarse, y estos son ejemplos claros del poder de la descentralización que nos permite el ecosistema de Bitcoin. Espero que les haya gustado este video y nos veremos en otra ocasión.

---

Saludos, en este video les explicaremos uno de los pilares fundamentales que permiten que Bitcoin pueda ser lo que llamamos dinero digital programable. Esto es posible gracias a Bitcoin Script, un sistema de script que le permite a Bitcoin programar de forma interna las operaciones que se realizan dentro de lo que sería su red blockchain o la red de nodos que forman parte de esta red conocida como Bitcoin. Bitcoin Script es un lenguaje de programación bastante sencillo, es muy muy muy pequeño en sus aspectos, en lo que puedes hacer con él, pero que tiene una funcionalidad muy muy relevante y es permitirle a los programadores de de programar. de la red Bitcoin y a los usuarios poder llegar y transferir valor de forma completamente digital y programable entre los diferentes pares que están dentro de la red. No solamente eso. Bitcoin Script es lo que se encarga de hacer posible que mis transferencias o las transferencias que hagamos dentro de la red lleguen desde el punto A al punto B de forma segura y de que solo las personas que están en medio de esa transacción sean las autorizadas para poder llegar y utilizar este valor que se está transmitiendo. ¿Cómo hace posible esto Bitcoin Script? Pues bien, Bitcoin Script lo que hace es que utiliza el poder o une el poder de la criptografía con el de la programación para llegar y habilitar a los usuarios de la red el uso de las diferentes transacciones que se realizan dentro de la red. Por ejemplo, si yo como usuario transmito dinero utilizando mis entradas de Bitcoin a una persona, yo estoy utilizando mis entradas y para eso genero un script específico que me permite utilizar mis entradas, desbloquearlas y enviarlas a esa segunda persona o a esa tercera persona para que esta persona entonces tenga la habilidad de utilizar sus propios scripts y poder realizar este pago o los pagos consecuentes que vaya a realizar después de recibir este dinero. Por supuesto, todo esto que estoy diciendo pasa completamente desapercibido porque se realiza de forma completamente transparente al usuario. La idea de Bitcoin Script es que los programadores de Bitcoin puedan llegar y habilitar opciones de transacciones digitales completamente nuevas para la red Bitcoin y que esto sea completamente transparente a los usuarios porque lo único que importa en este punto para los usuarios es que puedan realizar sus operaciones sin mayores inconvenientes. Ahora bien, Bitcoin Script es normalmente conocido como un lenguaje del tipo stack o de pila. Es decir. Las operaciones que se realizan con Bitcoin Script se apilan unas sobre otras y luego se ejecutan para llegar y tener una entrada de datos y una salida de la misma. Esto obviamente facilita la generación de... nodos que puedan llegar e interpretar toda esta información de forma bastante universal y que puedan tener todos los nodos un consenso sobre si una transacción es válida o no. Para ello, Bitcoin Script se vale de una serie de instrucciones que se le conocen como opcodes o códigos de operación. Que en esta página, que es la página, la wiki oficial de Bitcoin, podemos ver... ¿Cuáles son estos hub codes? Los hub codes simplemente nos permiten llegar e introducir datos dentro de lo que sería Bitcoin Script para que sean validados o sean ejecutados por los diferentes nodes. Y esto es un punto muy importante que te quiero hacer énfasis, y es que, al igual que como pasa en Ethereum, con Solidity, en el que programamos algo, y la Ethereum Virtual Machine agarra esa información, ese smart contract, lo procesa y lo transforma en operaciones. Lo mismo pasa con Bitcoin, pero a un nivel mucho más sencillo. porque en Bitcoin no tenemos una máquina virtual como tal, sino una máquina que se encarga, o un ejecutor que se encarga de tomar el Bitcoin Script, realizar las ejecuciones o las operaciones que está pidiendo, y allí tener la certeza de si la operación es o no pálida para llegar a incluirla dentro de lo que serían los blocks. Ahora bien, ¿qué operaciones podemos hacer o qué rango de operaciones tenemos disponibles dentro de Bconstruct? Pues bien, aquí... En la página podemos ver la anotación que tenemos disponible dentro de Bitcoin Script. Varios de estos códigos han sido desactivados por los desarrolladores de Bitcoin debido a problemas de seguridad. Y la idea es mantener Bitcoin Script lo más sencillo posible, pero también lo más seguro posible. Entonces, entre esas anotaciones, entre esas operaciones que podemos realizar, podemos conseguir los siguientes opcodes y las diferentes capacidades que pueden realizar. Por ejemplo, en el parte de constante, podemos definir constantes con palabras como op0 o opfals, que nos permiten identificar un arreglo de datos vacíos dentro del stack que se está ejecutando de Bitcoin Script. Recordemos que esto significa que se va a llevar al stack o a la pila de ejecución un dato vacío que no tiene ningún valor para que sea identificado. analizado por lo que sería el ejecutor de Bitcoin Script dentro de los nodos. También tenemos operaciones especiales como son opPushData, que simplemente nos indican que debemos una determinada cantidad de datos a la pila, dependiendo de una entrada que le estemos otorgando. También tenemos opEngage, que es también llevar el número menos uno a la stack, o hacer op1True, OP1 o OPTrue, que sería hacer operaciones del tipo lógico dentro del stack. También tenemos operaciones que nos permiten, códigos de operaciones que nos permiten hacer control de flujo. Esto es importante porque recordemos que Bitcoin Script no solamente es un lenguaje de script, es un lenguaje de programación que sea limitado en sus funciones, no le quita la capacidad de tener un control de flujo. Es decir... la capacidad de decidir si se hace una iteración o no se hace, dependiendo de determinadas condiciones. Para ello, tenemos códigos como lo son opNode, que es no hacer nada, prácticamente. opIf, que es si hay una condición y esa condición se cumple, se va a realizar una determinada condición. opNotIf, que es no si se cumple una condición. OPERF, SINO, en este caso, que es también otra opción de control de flujo bastante utilizada. OPDIF, que es en la finalización de una operación, en caso de que sea inválida. OPVERIFY, que es la verificación de una operación, y OPRETURE, que simplemente nos ayuda a marcar nuestra situación como inválida y es utilizada en muchas operaciones como la base para llegar y realizar las Coinbase. OPRETURE es una de las operaciones bastante más utilizadas en este sentido porque nos permite llegar y empujar o añadir informaciones que no deben ser analizadas directamente, sino que son marcadas como inválidas o que directamente son vistas como una información que puede ser agregada a la blockchain sin ningún tipo de procesamiento por parte de lo que sería la máquina de consenso dentro de Bitcoin. También tenemos el control del stack, que en este caso son varias operaciones, como sería la duplicación del stack, la apertura del stub, dropear una instrucción, en este caso, para dropear una instrucción se utiliza el opcode opdrop, para duplicar se utiliza el opcode opdup, y así sucesivamente tenemos una serie de operaciones que nos permiten llegar y manejar diferentes operaciones que podríamos utilizar o que generalmente utilizamos dentro de las capacidades de Bitcoin Script. Un apunte importante, siendo Bitcoin dinero programable, está la capacidad de realizar operaciones aritméticas. Sumar, restar, multiplicar, este tipo de operaciones son también posibles utilizándose con Bitcoin Script. Y para ello, contamos con varios opcodes que son los que vemos aquí ahora en pantalla. como el opcode va a sumar, para sustraer, para multiplicar y para dividir. Muy importante en este punto, que son los opcodes de multiplicación y división, es que están desactivados. Y están desactivados debido a un problema que se descubrió dentro de Bitcoin que llegaba y permitía a ciertos usuarios manipular estos opcodes para llegar y realizar operaciones que estuvieran mal formadas, pero que fueran validadas por el nodo y que al final, pudieran permitirle obtener ingresos de forma completamente maliciosa. Estos opcodes fueron desactivados por el equipo y desde entonces se han mantenido así. Y fíjense que no son los únicos. Hay varios opcodes, por ejemplo, los opcodes de Splice y de Lógica. Por BIT también hay varios de ellos desactivados precisamente por razones de seguridad. También vemos que tenemos opcodes para las partes de multiplicación, la división, para la mod, para lo que es el resto de una división, otro número de operaciones aritméticas, como para verificar si un número es igual a otro, para saber si es menor o igual, si es mayor. Este tipo de operaciones también se pueden realizar con el sistema de Bitcoin Script. En un principio, también había dicho que con Bitcoin Script se pueden hacer operaciones de tipo cripto. Y esto tiene todo sentido porque la manera en que verificamos operaciones dentro de Bitcoin, tiene que utilizar la criptografía. Y para ello, Bitcoin Script tiene las siguientes funciones o los diferentes códigos de operación disponibles, que son RIPEN 160, que es utilizar el hash RIPEN 160 dentro de una operación, SHA1, SHA256, que es el usual SHA256 que hemos visto ya en otros videos. OPHash 160, que es la aplicación de SHA-256 y RipenDX 160 para generar diferentes hashes especiales para Bitcoin. En este caso, por ejemplo, puede ser la dirección de una cuenta de Bitcoin. OPCodeSeparator, que es una operación que realmente no hace nada, sino que hace simplemente un chequeo de firmas. OPCheckSeq. que en este caso, OpenChecksheet, en locom número 172, lo que hace es verificar si una firma pública que hemos añadido dentro de Bitcoin Script es correcta, dependiendo de los datos que le hayamos otorgado. Checksheet Verify, que es la verificación de esa firma. y OPEP Check Multi-SIG, que es la que nos permite crear monederos de múltiples firmas. Esta es la operación que hace posible esa capacidad. También tenemos operaciones de lock time o de bloqueo por tiempo, como en este caso es OPEP Check Lock Time Verify, o como se le conoce también CLTB. que es una transacción especial que nos permite llegar y bloquear determinadas cantidades de criptomonedas, en este caso Bitcoin, por un determinado tiempo hasta que se verifiquen o se cumplan ciertas condiciones. Y también tenemos, en un mismo sentido, OPEC Check Sequences Verify, o también conocido como CSV, que tienen unas funciones bastante parecidas a CLTV, pero que en este caso, en vez de utilizar un lock time o una... o un bloqueo de tiempo, utilizan un sistema de secuencias, tal como lo ejemplifica el VIP 060268, que es el que se encarga de este tipo de operaciones. Ahora bien, ya que conocemos un poco las operaciones que están dentro de... lo que sería Bitcoin Script, sus diferentes opcodes, que recomiendo leer y reconocer bien esta página si quieres entrar en lo que es el mundo de programación de Bitcoin directamente con los Bitcoin Script, que no es la única manera de entrar. Puedes utilizar wrappers como lo que son Python, Python B, que... BTC, que te permite llegar y programar operaciones con Python, pero que luego son traducidas a los OCOPS necesarios para llegar y generar transacciones que puedan ser entendidas por la red Bitcoin. En todo caso, esta lista de operaciones que están aquí de opcodes, nos dicen una cosa muy clara sobre Bitcoin Script, y es que podemos programar operaciones de distintas índoles con el mismo. Y esto elimina un poco la idea de que Bitcoin Script no tiene la capacidad de programar smart contracts. Bitcoin Script tiene la capacidad de programar smart contracts. De hecho, cada vez que haces una transacción en Bitcoin, las operaciones de las distintas índoles se pueden programar en el mismo sistema. Y esto es lo que nos permite, en este caso, programar una transacción en Bitcoin Script. Y esto es lo que nos permite, en este caso, programar una transacción en Bitcoin Script. Y esto es lo que nos permite, en este caso, programar una transacción en Bitcoin Script. Y esto es lo que nos permite, en este caso, programar una transacción en Bitcoin Script. Y esto es lo que nos permite, en este caso, programar una transacción en Bitcoin Script. Y esto es lo que nos permite, Esa transacción es posible por un pequeño smart contract dentro de esa operación, porque Bitcoin Script es un lenguaje de tipo smart contract. La diferencia entre smart contracts de Ethereum y Bitcoin es que los smart contracts de Bitcoin no son Turing completos. ¿Qué significa esto? Que no podemos crear estructuras extremadamente complejas en comparación con lo que podemos hacer con Solidity. Por ejemplo, no podríamos crear con todos estos opcodes que hemos visto, no podríamos crear un oráculo blockchain, por ejemplo, como una especie de chain link sobre Bitcoin, porque no hay la capacidad para este tipo de operaciones. Sin embargo, los operadores o los desarrolladores de Bitcoin entienden que estas limitaciones deben ser superadas y para eso se han creado diferentes sistemas, como es el caso de Miniscript, como es el caso de los wrappers que he comentado para Python o para otros lenguajes de programación. Estos wrappers y estas extensiones lo que buscan es llevar a Bitcoin a más lugares para que pueda ser utilizado y potenciado su uso. Más allá de esto, para ver cómo funciona Bitcoin Script en realidad. Vamos a ver unos pequeños ejemplos y los voy a mostrar en pantalla. para que vean cómo es la programación de un Bitcoin Script. Y también voy a mostrar hasta dónde se puede llevar este potencial. Vamos a reducir un poco esta pantalla aquí. Y vamos aquí a nuestra cónsola. En este caso ya tenemos algunos ejemplos ya preparados. Voy a mostrar el ejemplo número uno. En este caso tenemos un comando llamado btcd. que en este caso tenemos una serie de datos que voy a ir demostrando. Este primer dato que ustedes ven aquí es nuestra firma de Bitcoin. Nuestra firma como tal. Luego viene la firma hacheada. Y aquí vienen nuestras operaciones. Voy a poner esto aquí de manera que podamos revisarla poco a poco. Esto que ven aquí, esta línea que estoy recorriendo aquí en pantalla, es una dirección de Bitcoin. Pueden verificarla directamente en un mempool. Y aquí están nuestras operaciones completas. Muy bien. Aquí lo que vemos es lo siguiente. Aquí tenemos... vemos esto que está aquí arriba, estas dos líneas, pertenecen a nuestro script bookkeep. Nuestro script bookkeep, lo que contiene es la información de nuestra llave pública y la firma correspondiente para movilizar una determinada cantidad de criptomonedas que estén dentro de una dirección. En este caso, la dirección que estamos viendo es la dirección 12AB8, esta que estoy mostrando aquí. Y esto lo que nos dice a Bitcoin Script es que mira, tenemos esta dirección, tenemos esta firma y tenemos estos scripts. Vamos a tomar estos scripts, los vas a ejecutar dentro de un nodo y vas a verificar si todo es correcto, porque si todo es correcto, esta persona puede movilizar el dinero que está en esa dirección y mandarlo a quien lo está enviando. Entonces, el primer cuerpo que tenemos aquí, estas dos primeras líneas, sería nuestro script bouquet. Y luego viene nuestro script como tal. Aquí lo primero que hacemos es una duplicación de la pila. que en este caso va a tomar esta información que está aquí y la va a duplicar. Va a hacer un hash 160. Es decir, va a llegar y va a hacer un hash ripen de 160 y doble sh256. Y luego va a tomar esta dirección, va a verificar si son iguales, y luego va a verificar las firmas. Para ejecutar esto, para ejecutar este Bitcoin Script y verlo más gráficamente, vamos a salir un momento aquí. Vamos a limpiar la pantalla. Vamos a hacer lo siguiente. Bash, ejemplo 01. Y vamos a ejecutar un debuqueador llamado btcdep, que lo podemos buscar aquí. Vamos a buscar rapidito antes de... para mostrarles dónde pueden buscar este debuqueador. btcdep, aquí está. Este es Bitcoin Script Debugger, esto es un debugueador de Bitcoin Script, es oficial de Bitcoin y pueden utilizarlo con completa confianza, es bastante sencillo de compilar para que se pueda agregar su funcionamiento. Muy bien, ahora que sabemos dónde podemos conseguir la herramienta BTCDEP, que es la que vamos a utilizar. Vamos a ejecutar un pequeño script con un ejemplo de transacción que ya hemos modificado, que es el ejemplo que estábamos viendo ahorita en pantalla. Vamos a hacer entonces... Voy a limpiar la pantalla nuevamente. Bash ejemplo 01. Y aquí tenemos a VTCdev ejecutando nuestro script. En este caso, el script que había mostrado en pantalla ya está cargado. Aquí podemos ver el script en forma de pila. y vamos a ir ejecutando paso a paso cada una de estas operaciones. El primer paso es tomar y duplicar todo el stack superior. Ya aquí está. PushStack se ha duplicado. Ya tenemos el primer paso aquí y aquí. Seguimos el segundo paso. Y ya tenemos el segundo paso, ya la pila se sigue reduciendo y vamos haciendo la ejecución continua de este script. Lo siguiente que hacemos es duplicar nuevamente la línea anterior y aquí tenemos el script ya duplicado. Fíjense que tenemos aquí nuestras firmas ya duplicadas. Bien. Vamos a hacer entonces el siguiente paso que es aplicar el ophash 160. ¿Qué va a pasar aquí? Lo que va a pasar es que vamos a agarrar la firma pública, que en este caso es la 044, esta que está acá. Vamos a agarrar esta firma pública. y la vamos a transformar en una dirección de Bitcoin, que en este caso debería ser igual a la dirección 12AB8 que estamos viendo aquí abajo. Vamos a ejecutar el siguiente paso y deberíamos obtener la dirección. Y efectivamente, en el lado del script tenemos nuestra dirección, 12AB8, y en el lado del stack ejecutándose dentro de VTC DEP, tenemos la misma dirección. Efectivamente, la firma que estamos tomando de esta operación es correcta y nos está generando la dirección que necesitamos para llegar y hacer la verificación. Ahora, el siguiente paso es enviar la firma que nos está dando el script. Y ahí está. Ahora, estas dos firmas que están acá, las vamos a verificar con op equal verify. El siguiente paso lo ejecutamos. Y efectivamente, las operaciones son correctas. El script nos está diciendo que las direcciones son idénticas y por ser idénticas nos da la capacidad para seguir con la operación. Finalmente, lo que quedaría es verificar si la firma es correcta y pertenece a quien dice pertenecer. y aplicando el siguiente paso, podemos ver que efectivamente sí, la firma es completamente idéntica y pertenece a quien dice pertenecer. Finalizamos. Y con ello ya hemos terminado la ejecución de un primer Bitcoin Script. Este proceso que acabo de explicar aquí de forma bastante gráfica con BTCDEV. Es el mismo proceso que se realiza una y otra vez con cada una de las operaciones que se tienen o se llevan a cabo dentro de Bitcoin. Cada vez que un menero genera un bloque e incluye 1.000, 1.200 transacciones dentro de ese bloque y estos bloques llegan a los nodos, los nodos realizan estas operaciones una y otra vez hasta que terminan con las 1200 operaciones y con ello verifican que todo esté correcto. Luego de verificar que todo esté correcto, simplemente llegan y ingresan el bloque que ha enviado el dinero a lo que sería el listoreo de la blockchain y con ello se da el visto bueno a ese bloque, se valida y se genera consenso en la red. Todo este proceso se repite una y otra vez todo el tiempo dentro de Bitcoin y dentro de monedas, y que funcionan con el esquema de Bitcoin. Por ejemplo, puede ser Dash, que tiene un sistema muy parecido a lo que es Bitcoin Script. Puede ser Zcash, que también tiene un sistema bastante parecido. Monero también tiene un sistema muy parecido, con adaptaciones para lo que serían sus Bulletproof y lo que sería su máquina virtual, porque ellos sí tienen una máquina virtual a nivel de ejecución. Pero la forma básica, las bases, son estas que acabamos de ver en este ejemplo. Si salimos aquí, podemos llegar y cerrar. Y ya con eso hemos terminado con un primer ejemplo. Vamos a ver un segundo ejemplo que he tenido preparado ya por aquí. En este caso, ejemplo 02. Y vamos a crecer aquí. Y aquí cambia un poco la cuestión. Aquí vemos operaciones nuevas. y vamos a explicar un poco de qué van estas operaciones nuevas. Vamos a dividir un poco el script para hacerlo más legible. Y luego les explicaré poco a poco cómo es cada una de estas operaciones. En este caso ya tenemos los PDUP, POPPASH, PUSHBYTE, y tenemos aquí un tema de dirección y el HX. OK, perfecto. Ya tenemos aquí. Lo que ven en pantalla, aquí en la cónsula, es una transacción del tipo SetTweet. Una transacción del tipo SetTweet como las que vemos normalmente en la actualidad dentro de la red, porque prácticamente la mayoría de las transacciones que se hacen o son tipo SetTweet o P2SH, que son muy parecidas también. Y en este caso, el script cambia un poco. El script empieza primero con un push byte de 72 y un pushbyte de 65. Y al final me da una pubkey, una clave pública. Luego nos está pidiendo que hagamos una duplicación del stack, que hagamos un hash 160 y luego hagamos un pushbyte 20. Es decir, vamos a tomar los últimos 20 bytes y vamos a hacer un push para llegar y verificar si esto es idéntico a lo que tenemos dentro del stack. Así funciona ZTwist. Aquí, como se puede ver, nos hace falta la formación de las claves como tal, porque ZWIT lo que hace es dividir esta información en dos partes. Las claves van por un lado, en lo que llamamos el witness o testigo, y la información de la transacción como tal va por el otro, que es lo que vamos a verificar en este punto. Entonces, vamos a hacer aquí, salimos, y vamos a ejecutar este ejemplo. y aquí tenemos nuestro stack cargado. Tenemos aquí unas... Warnings que en este caso serían... debido a que el BTC no está completamente sincronizado con los operadores de código de Bitcoin Script. Pero podemos simplemente obviar esto y seguir adelante. Vamos a hacer el primer paso. Y ahí cargamos la primera parte del stack. El segundo paso. Ya descargado, seguimos cargando el siguiente paso. Y aquí empiezan las operaciones de manipulación, de información y de verificación. Aquí lo primero que vamos a hacer es una duplicación. Y, efectivamente, ya podemos ver la duplicación hecha. Aquí está. Luego viene la realización del hash 160. Y aquí está nuestro hash 160 de la anterior operación. Seguimos entonces con el siguiente paso que es hacer el pushbite y finalmente cargamos la información de la firma y hacemos la verificación. y efectivamente la firma es correcta. Hemos conseguido que la información sea correcta y que nos lo valide la operación. Esto significa que la operación setWidth que acabamos de ver es correcta. Dentro de lo que sería el script que va a esta operación setWidth, todas las operaciones están correctas. Seguimos y verificamos que efectivamente todo está perfectamente. Entonces, como puedes ver, es bastante sencillo utilizar BTCDEV para llegar y programar este tipo de cuestiones. Pueden ser directamente transacciones que hayas sacado de lo que serían las operaciones de la main pool, o de lo que serían las operaciones dentro de Bitcoin. Por ejemplo, aquí podemos ver una transacción. Y si vamos a los detalles, podemos ver toda la información necesaria para tal cuestión. Aquí está el script. Simplemente. tomaríamos esta información, lo colocaríamos dentro de BTCDepth y ya con ello podríamos verificar si efectivamente este script, tal como está escrito, que en este caso es una operación setwith y de tipo multifirma, tal como aparece aquí en la pantalla, ya con esto podríamos llegar a incluirlo dentro de BTCDepth y verificar si efectivamente la operación es correcta. o podemos ir paso a paso como sería lo ideal. En este caso, por ejemplo, si quiero hacer algo muy sencillo, como sería una suma, podríamos llegar y escribirlo. BTCDEP OP1, OP2, OPADD. Y aquí ya tendríamos nuestro primer stack. Tendríamos el número 1, el número 2 y el OPADD. Simplemente pasamos paso por paso. y tenemos nuestra operación de suma. La capacidad de BTC y de Bitcoin Script para permitirnos programar es muy amplia, aunque no llega a los niveles de Solidity o de otros lenguajes de programación Smart Contract Turing completo. BTC, Bitcoin Script, nos permite hacer muchas cosas completamente increíbles a nivel de programación descentralizada. Y quiero mostrarles parte de ese poder. Vamos aquí a un proyecto que utiliza Bitcoin Script para realizar un mercado de intercambio, un DEX, un exchange descentralizado. Este es Pisk. y BISC es un exchange descentralizado que funciona dentro de Bitcoin. De hecho, cuando instalas BISC, realmente estás instalando un nodo de Bitcoin que funciona de forma completamente descentralizada. No tiene ningún intermediario, no funciona con un servidor web como funciona en otros servicios descentralizados, como en el caso de Uniswap. No necesitas ningún intermediario, como sería Infura en el caso de Uniswap y su wallet MetaMask. absolutamente nada simplemente descargas este software te instala tu propio nodo, te instala todos los servicios que necesitas y te conecta directamente a un exchange descentralizado en el que puedes intercambiar cualquier tipo de moneda y se ve tal cual como ves en pantalla Este es un ejemplo del potencial que existe detrás de Bitcoin Script. No solamente es para programar operaciones sencillas. También puedes utilizarlo para programar aplicaciones como estas, que son mucho más complejas, que se apoyan en otras tecnologías para llegar y complementarse y poder realizar operaciones o aplicaciones, en este caso, para poder crear aplicaciones que sean completamente centralizadas y que no tienen nada que envidiar a otras. a otras plataformas como serían Ethereum, Polkadot o cualquier otro tipo de plataforma web 3 como la conocemos normalmente, pero que también y extrañamente entra en lo que sería web 3. La web 3 y el corazón de este MBA es demostrar de que el mundo es un mundo. web tal como lo conocemos ahora puede descentralizarse y estos son ejemplos muy claros del poder de la descentralización que nos permite el AppKeychain. Espero que les haya gustado este video y nos veremos en otra ocasión.