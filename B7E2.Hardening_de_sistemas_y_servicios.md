---
title: Hardening de Sistemas y Servicios | Washington Gómez
URL: https://app.web3mba.io/courses/take/bloque-7-electiva-2-hardening-de-sistemas-y-servicios/lessons/40125951-e2-hardening-de-sistemas-y-servicios-washington-gomez
Tags/Keywords: null
---

### 431.B7E2_Hardening_de_Sistemas_y_Servicios-video

### Hardening de Sistemas y Servicios
![[431.B7E2_Hardening_de_Sistemas_y_Servicios.mp4]]
[Hardening de Sistemas y Servicios](https://app.web3mba.io?wvideo=gkhltba83q)

Lo que siente el activador sobre Hardening. Hoy en día, existen metodologías para fortificar los sistemas. Estas metodologías, tradicionalmente conocidas como Hardening, son las que se utilizan en el sistema de control de la luz. Lo que nos permiten es seguir determinadas guías que ya están disponibles públicamente. Las más conocidas suelen ser las guías de C-Security, que es una empresa dedicada a generar guías de hardening. Se conocen como benchmarks también en inglés. Estas guías nos permiten generarlas, seguirlas y poder hardenizar o mejorar la seguridad de nuestros sistemas.

Las guías de hardening, a diferencia de otras guías, no son únicas, sino que suelen estar asociadas a distintas tecnologías o a diferentes equipamientos informáticos. Por ejemplo, podemos encontrar guías de hardening para Switch Cisco, para Switch Fortinet, así como guías de hardening para Firewall Checkpoint y para firewalls de distintas marcas. También podemos encontrar guías de hardening por sistemas operativos, como Linux, Windows y Mac. Además, contamos con guías de hardening a nivel de aplicaciones o aplicativos. Por ejemplo, en el ámbito de los servidores de aplicación, podemos encontrar guías de hardening para Tomcat, para JBoss y para otros servidores de aplicación, así como para una gran cantidad de distintos aplicativos, como Nginx, Apache y muchas otras aplicaciones que solemos usar día a día.

¿Qué son básicamente las guías de hardening? Las guías de hardening son documentos de buenas prácticas que nos permiten, a partir de distintas configuraciones en estos equipos, sistemas operativos o aplicaciones, aumentar el nivel de seguridad de los mismos. Un caso práctico de lo que es el hardening, o de la ausencia de este, lo podemos observar, por ejemplo, al ingresar a un sitio web, escribir una dirección errónea y lo primero que nos devuelve nuestro navegador es un error en el cual, debajo, se puede leer la versión que se está utilizando y qué aplicativo se está empleando. El más común es encontrar mensajes de error que indican, por ejemplo, "Apache, WebServer, versión 2.1.4" o "Tomcat", entre otros. Esto sucede porque ese servidor o aplicativo no ha recibido la aplicación de guías de hardening, lo que puede suponer un riesgo para la organización.

¿Por qué? Porque estamos ante lo que se llama Information Disclosure. Estamos proporcionando información a un posible atacante sobre qué sistemas estamos utilizando. Por ejemplo, si nuestro sitio web está instalado, por llamarlo de alguna manera, en un servidor que ejecuta Apache y que está en la versión 2.1.4, esto permite que un atacante busque en Internet posibles formas de explotar vulnerabilidades relacionadas con ese aplicativo y esa versión. Así, al buscar vulnerabilidades para explotar Apache versión 2.1.4, puedo encontrar una lista considerable de exploits que me permitirán intentar vulnerar la seguridad de ese sitio web.

La guía de hardening lo que hace es garantizarnos que todas las configuraciones por defecto que vienen en las aplicaciones, sistemas o equipos sean debidamente tratadas, mejorando así la postura de seguridad de nuestros sistemas y equipos. Por ejemplo, otro caso práctico son los firewalls. Los firewalls o equipos de comunicaciones suelen venir con usuarios predeterminados, como "admin" y "admin" como contraseña. Muchas veces, aunque en organizaciones es más difícil, a nivel doméstico solemos dejar las claves predeterminadas que vienen en los equipos, en los routers y en los firewalls de Internet. También dejamos usuarios predeterminados creados, los cuales deberíamos deshabilitar si aplicamos unas correctas guías de hardening, para evitar posibles intrusiones.

Todos sabemos que Microsoft, hace unos años, tenía el usuario invitado activo, que no requería credenciales y que permitía a cualquier persona ingresar al sistema utilizando esta cuenta. Con el tiempo, se ha dado cuenta de que no es una buena práctica; incluso en versiones posteriores, ya traían ese usuario deshabilitado, y hoy en día, en algunas versiones más recientes, ni siquiera existe la posibilidad de tener un usuario invitado. La ventaja del hardening es que, al aplicar esta guía, nos garantizamos que, por ejemplo, los servicios que no utilicemos en nuestros sistemas no estén activos. Servicios que, por ejemplo, se instalan de forma predeterminada y que vienen con una configuración por defecto, pueden ser personalizados, evitando que muestren las versiones y permitiendo que los usuarios que vienen por defecto no sean utilizados, creando nosotros nuestros propios usuarios.

Generalmente, cuando uno realiza una instalación de estos aplicativos, suelen venir los features o ítems de seguridad deshabilitados. Estas guías de hardening nos proporcionan todas las buenas prácticas para habilitar esos controles de seguridad, eliminar usuarios que vienen por defecto y establecer una contraseña, por ejemplo, a un equipo físico, un firewall o un puerto que nos permite conectarnos a la consola del equipo físicamente. Todo este tipo de seguridad nos la proporcionan las guías de hardening. Es una forma de buenas prácticas que debemos seguir para que todos nuestros aplicativos, ya sean sistemas operativos o aplicaciones a nivel de hardware, nos permitan estar tranquilos y seguros de que no estamos exponiendo nada que haya venido de forma predeterminada, lo cual podría ser un vector de ataque explotable por algún atacante.

Las guías de hardening, como comenté anteriormente, más conocidas son las de C-Security, que son accesibles de forma gratuita desde Internet y que, a través de ellas, hoy en día, la mayoría de las empresas las utilizan para hardenizar todos sus equipos. Otro ejemplo que podemos observar en lo que respecta al hardening es cuando ingresamos a algunos sitios web y podemos ver que, frente a un error, aparece una gran cantidad de información que nos permite entender qué tecnología está utilizando la empresa. Por ejemplo, si hay una base de datos, a veces, cuando falla la conexión a la base de datos y entramos a un sitio web, se nos presenta la falla de la conexión. Este tipo de mensajes suelen ocurrir cuando las organizaciones no aplican guías de hardening, lo que no asegura que todos los mensajes predeterminados y las pantallas de error sean personalizadas, etcétera, lo que nos permite mejorar en todos los aspectos de seguridad que tienen todos los dispositivos, aplicaciones y sistemas operativos de forma predeterminada.

El año pasado, hubo un ataque bastante conocido en el cual se utilizaba un servicio de Microsoft que suele dejarse habilitado de forma predeterminada. Este servicio es utilizado por Microsoft para reportar errores a su propia plataforma. Cuando uno tiene un error en Windows y aparece una pantalla o algún error a nivel de sistema operativo, este servicio informa a Microsoft de que ese sistema operativo ha tenido un error, recabando esa información para luego poder sacar fixes, actualizaciones, entre otros. El año pasado, este servicio fue utilizado por atacantes para robar información. Cuando se preguntó a la mayoría de las empresas si estaban utilizando este servicio, un alto porcentaje de las personas consultadas afirmaron que sí lo tenían activo, a pesar de que no era útil para la propia empresa, ni para la organización, ni para la aplicación que estaba ejecutando ese servidor. Sin embargo, como era un servicio que ya venía iniciado, quedó activo.

Si se consulta la guía de Sys de hardening, se puede visualizar que este servicio es uno de los que se recomienda deshabilitar en todos los servidores Windows y plataformas Microsoft. Sin embargo, en un alto porcentaje de empresas, al no aplicar estas guías de hardening, se vieron afectadas por este ataque que, como mencioné anteriormente, utilizó este servicio nativo de Microsoft para enviar errores, el cual fue aprovechado para enviar información sensible y, de esta forma, hacer uso de la información de esos equipos.


### 432.B7E2.1_Auditoría_de_Sistemas-Hardening

### Fundamentos de Hardening
![[432.B7E2_hardening..png]]

Hardening, la acepción en inglés de "endurecimiento", aplicado en seguridad informática es el proceso de asegurar un sistema mediante la reducción de vulnerabilidades en el mismo.

Esto se consigue eliminando software, servicios, usuarios, etc. innecesarios en el sistema, así como cerrando puertos que tampoco estén en uso, además de muchos otros métodos y técnicas que veremos durante este pequeño resumen introductorio al Hardening de sistemas.

Es un conjunto de actividades que son llevadas a cabo por el administrador de un sistema operativo para reforzar al máximo posible la seguridad de su equipo. **¿Su propósito?: Entorpecer la labor del atacante y ganar tiempo para poder minimizar las consecuencias de un inminente incidente de seguridad e incluso, en algunos casos, evitar que este se concrete en su totalidad.**

Una de las primeras cosas que hay que dejar en claro del Hardening de sistemas operativos es que no necesariamente logrará forjar equipos “invulnerables”. Es importante recordar que, según el modelo de defensa en profundidad, el host es solo una capa de este. En otras palabras, un factor más a considerar dentro del gran número de puntos a ser tomados en cuenta para defender “globalmente” un sistema.

#### Elementos básicos de Hardening de sistemas
1. **Configuraciones necesarias para protegerse de posibles ataques físicos o de hardware de la máquina.** Entre otras actividades, destacan el upgrade de firmware, el establecimiento de contraseñas complejas para el arranque del equipo y la configuración de la BIOS, la deshabilitación de inicio de sistema para cualquier unidad que no sea el disco duro principal, y en casos de servidores, la deshabilitación de dispositivos ópticos, usb o similares, para evitar cualquier entrada de malware desde un medio de almacenamiento externo.
2. **Instalación segura del sistema operativo.** Esto implica, entre otras cosas, el considerar al menos dos particiones primarias (1 para el sistema operativo en sí y otra para carpetas y archivos de importancia), el uso de un sistema de archivos que tenga prestaciones de seguridad, y el concepto de instalación mínima, es decir, evitando la instalación de cualquier componente de sistema que no sea necesario para el funcionamiento del sistema.
3. **Activación y/o configuración adecuada de servicios de actualizaciones automáticas,** para asegurar que el equipo tendrá todos los parches de seguridad que entrega el proveedor al día. En caso de que se encuentre dentro de una corporación, es adecuado instalar un servidor de actualizaciones, que deberá probar en un entorno de laboratorio el impacto de la instalación de actualizaciones antes de instalarlas en producción.
4. **Instalación, configuración y mantención de programas de seguridad** tales como Antivirus, Antispyware, y un filtro Antispam según las necesidades del sistema.
5. **Configuración de la política local del sistema,** considerando varios puntos relevantes:
6. **Política de contraseñas robusta,** con claves caducables, almacenamiento histórico de contraseñas (para no usar contraseñas cíclicas), bloqueos de cuentas por intentos erróneos y requisitos de complejidad de contraseñas.
7. **Renombramiento y posterior deshabilitación de cuentas estándar del sistema,** como administrador e invitado.
8. **Asignación correcta de derechos de usuario,** de tal manera de reducir las posibilidades de elevación de privilegios, y tratando siempre de limitar al mínimo los privilegios y/o derechos de los usuarios activos.
9. **Configuración de opciones de seguridad generales,** como aquellas relacionadas con rutas de acceso compartido, apagado de sistema, inicio y cierre de sesión y opciones de seguridad de red.
10. **Restricciones de software,** basado en lo posible en el uso de listas blancas de software permitido más que en listas negras del mismo.
11. **Activación de auditorías de sistema,** claves para tener un registro de algunos intentos de ataque característicos como la adivinación de contraseñas.
12. **Configuración de servicios de sistema.** En este punto es necesario tratar siempre de deshabilitar todos aquellos servicios que no vayan a prestar una funcionalidad necesaria para el funcionamiento del sistema. Por ejemplo, si su equipo no posee tarjetas de red inalámbrica, el servicio de redes inalámbricas debería estar deshabilitado.
13. **Configuración de los protocolos de Red.** En la medida de lo posible, es recomendable usar sistemas de traducción de direcciones (NAT) para direccionar los equipos internos de una organización. Deshabilitar todos aquellos protocolos de red innecesarios en el sistema y limitar el uso de los mismos al mínimo. TCP/IP es un protocolo que no nació pensando en seguridad, por lo que limitar su uso al estrictamente necesario es imperativo.
14. **Configuración adecuada de permisos de seguridad en archivos y carpetas del sistema.** En la medida de lo posible, denegar explícitamente cualquier permiso de archivo a las cuentas de acceso anónimas o que no tengan contraseña. Un correcto set de permisos a nivel de carpetas y archivos es clave para evitar acceso no deseado al contenido de los mismos.
15. **Configuración de opciones de seguridad de los distintos programas,** como clientes de correo electrónico, navegadores de internet y en general de cualquier tipo de programa que tenga interacción con la red.
16. **Configuración de acceso remoto. En caso de no ser estrictamente necesario, es bueno deshabilitar el acceso remoto.** Sin embargo, cuando es necesario tener control remoto de la máquina, es preciso configurarlo de manera adecuada, restringiendo el acceso a un número muy limitado de usuario, restringiendo al mínimo las conexiones concurrentes, tomando cuidado en la desconexión y cierre de sesión y estableciendo un canal cifrado de comunicaciones para tales propósitos, como SSH.
17. **Configuración adecuada de cuentas de usuario, tratando de trabajar la mayor parte del tiempo con cuentas de acceso limitado y deshabilitando las cuentas de administrador.** Es absolutamente recomendable usar la _impersonificación de usuarios_ para realizar labores administrativas en vez de iniciar sesión como administradores.
18. **Cifrado de archivos o unidades según las necesidades del sistema, considerando un almacenamiento externo para las llaves de descifrado.** Considerar además la opción de trabajar con sistemas de cifrado de mensajería instantánea y correo electrónico.
19. **Realizar y programar un sistema de respaldos frecuente a los archivos y al estado de sistema.** En la medida de lo posible, administrar los respaldos vía red o llevar los respaldos a unidades físicas que estén alejadas del equipo que las origina.

Como se puede ver, el espectro de actividades que deben ser llevadas a cabo dentro de este proceso es bien amplio y tiene actividades de todo tipo. Sin embargo, la consigna para todas estas actividades es siempre la misma: dejar el sistema operativo lo más restringido posible.

#### ¿Cuánta seguridad es suficiente?
¿Hasta qué punto el Hardening es una ayuda y no una molestia?

En este punto, es importante considerar un paradigma muy interesante que tiene la seguridad. Al parecer, la seguridad, por un lado, y la versatilidad y facilidad de uso de los sistemas, por otro, son como dos grupos de personas tirando de ambos extremos de una cuerda. 

En pocas palabras, a medida que se busca una seguridad mayor en los sistemas, la versatilidad y facilidad de uso del mismo se ven limitados, puesto que la cantidad de decisiones que puede tomar el usuario se reduce y la cantidad de posibilidades ajenas al propósito inicial del sistema en sí disminuye drásticamente. Por otro lado, el aumentar la versatilidad y la facilidad de uso de los sistemas pareciera estar muy relacionado con el aumento en las decisiones y posibilidades del usuario, lo que por consiguiente aumenta la probabilidad del mismo de equivocarse y poner en peligro la seguridad de todo el sistema. Y el debate sobre el punto exacto de equilibrio en cuanto a la cantidad de decisiones que deben pasar por manos del usuario final es bastante extenso y no está del todo resuelto.

Por lo tanto, la respuesta a la pregunta planteada es la siguiente: 
> El Hardening es una ayuda hasta el momento exacto en que entorpece el objetivo inicial que tiene el sistema.

Por citar un ejemplo, si un sistema trabaja con impresoras, redes inalámbricas y además con correo electrónico, no es recomendable deshabilitar la cola de impresión, el servicio de redes inalámbricas ni bloquear los puertos de SMTP y POP. 

En cada acción de Hardening que se vaya a ejecutar en el sistema operativo, hay que tener especial cuidado en que dichas acciones no afecten el propósito del sistema en sí.

##### Conclusión
El Hardening es una ayuda indispensable para ahorrarse bastantes dolores de cabeza por parte de los administradores de sistemas. 

Entre sus ventajas, se puede contar la disminución por incidentes de seguridad, mejoras en el rendimiento al disminuir niveles de carga inútil en el sistema, una administración más simple y mayor rapidez en la identificación de problemas, ya que muchas de las posibles causas de ellos quedarán descartadas en virtud de las medidas tomadas, y finalmente la posibilidad – en muchos casos – de poder hacer un seguimiento de los incidentes y en algunos casos identificar el origen de los mismos. Es un trabajo que no es trivial, pero que bien vale la pena hacerlo.


### 433.B7E2.1_Auditoría_de_Sistemas-Zero_Trust

### Principio Zero Trust
Zero Trust es un modelo de seguridad de red basado en la filosofía de que ninguna persona o dispositivo dentro o fuera de la red de una organización debe tener acceso para conectarse a sistemas o servicios de TI hasta que se autentique y se compruebe constantemente.

El modelo fue presentado en 2010, por el analista de investigación de Forrester, John Kindervag, quien propuso una solución que denominó "Zero Trust".

Fue un cambio de la estrategia de "confiar, pero verificar" a "nunca confiar, siempre comprobar". 

1. En el modelo Zero Trust, no se confía en ningún usuario o dispositivo para acceder a un recurso hasta que se compruebe su identidad y autorización. 
2. Este proceso se aplica a quienes suelen encontrarse en una red privada, como una persona empleada en un ordenador de empresa que trabaja de forma remota desde casa o en su dispositivo móvil durante una conferencia al otro lado del mundo. 
3. También se aplica a todas las personas o dispositivos fuera de esa red. No importa si ha accedido a la red antes o cuántas veces lo ha hecho: su identidad no es de confianza hasta que se vuelva a comprobar. 
4. La idea es suponer que cada máquina, usuario y servidor no son de confianza hasta que se demuestre lo contrario.

Históricamente, el enfoque de "castillo y foso" hacia la seguridad parecía viable; hubo un tiempo en que imperó la idea de un perímetro de red donde cualquiera que se encontrase fuera de la red (o foso) era "malo" y todos los que estuviesen dentro eran "buenos". 

> Al igual que los castillos y los fosos son cosa del pasado, también debe serlo este enfoque de seguridad casi medieval. Pensemos en la situación actual del trabajo remoto.

**La plantilla y el lugar de trabajo han cambiado:** Las personas han dejado atrás las cuatro paredes de una oficina y ahora trabajan en cualquier momento y de forma distinta. Con el auge de la nube, el perímetro de red ya no existe de la misma manera que antes. Es posible encontrar a los usuarios y las aplicaciones tanto a un lado como al otro del foso. Y eso añade vulnerabilidades al perímetro de las que los agentes maliciosos se pueden aprovechar. Una vez dentro del foso, pueden moverse libremente, acceder a recursos y activos de alto valor, como los datos de los clientes (¡o las joyas de la corona!); o lanzar un ataque de ransomware.

![[433.B7E2_ransomware.png]]

#### ¿Cómo funciona Zero Trust?
Imagine que el modelo Zero Trust es un guardia de seguridad extremadamente atento que revisa sus credenciales metódica y repetidamente antes de permitirle acceder al edificio de oficinas donde trabaja, incluso si ya le conoce. Después, repite ese proceso para verificar su identidad una y otra vez.

- El modelo Zero Trust se basa en una autenticación y autorización sólidas de cada dispositivo y persona antes de que tenga lugar cualquier acceso o transferencia de datos en una red privada, independientemente de si están dentro o fuera del perímetro de esa red. 
- El proceso también combina análisis, filtrado y registro para comprobar el comportamiento y para observar continuamente las señales de riesgo. 
- Si un usuario o dispositivo muestra indicios de que está actuando de manera diferente que antes, se tiene en cuenta y se supervisa como una posible amenaza. 

Pongamos un ejemplo:
- Marcus en Acme Co. suele iniciar sesión en Columbus, Ohio, en los Estados Unidos, pero hoy está intentando acceder a la intranet de Acme desde Berlín, Alemania. 
- Aunque el nombre de usuario y la contraseña de Marcus se ingresaran correctamente, un enfoque Zero Trust reconocería la anomalía en el comportamiento de Marcus y tomaría medidas, como someter a Marcus a otra prueba de autenticación para verificar su identidad.

Este cambio básico de estrategia acaba con muchas de las amenazas a la seguridad habituales. Los atacantes ya no pueden superar el foso para aprovecharse de las debilidades del perímetro y, posteriormente, de sus datos y aplicaciones confidenciales. Ya no hay foso que cruzar. Solo hay aplicaciones y usuarios, cada uno de los cuales debe autenticarse mutuamente y cuya autorización debe verificarse antes de concederse cualquier acceso. La autenticación mutua se produce cuando dos partes se autentican entre sí al mismo tiempo, como un usuario con unas credenciales y contraseña, y una aplicación con la que se conecta a través de un certificado digital.

#### Principios fundamentales detrás del acceso de red de Zero Trust
El modelo Zero Trust se basa en cinco principios básicos:
1. Siempre se presupone que todos los usuarios de una red son hostiles.
2. Existen amenazas externas e internas en la red en todo momento.
3. La localización de la red no es suficiente para decidir su nivel de confianza.
4. Cada dispositivo, usuario y flujo de red se autentica y autoriza.
5. Las políticas deben ser dinámicas y se deben calcular a partir de tantas fuentes de datos como sea posible.

#### Cuatro claves de la seguridad Zero Trust
Los siguientes son bloques de construcción que, cuando se unifican, proporcionan un camino para lograr la confianza cero en seguridad.

1. Verificar el Usuario
2. Verificar el Dispositivo
3. Limitar el acceso y los privilegios
4. Aprende y adapta

##### 1 | Verificar el usuario
Hoy en día, la forma más básica de verificar a un usuario es a través de un nombre de usuario y contraseña. 

Pero, ¿cómo podemos estar seguros de que el usuario es quien dice ser y no alguien que adivinó o falsificó la contraseña o compró credenciales comprometidas en la Dark Web? Se obtiene una seguridad de identidad adicional al mejorar las contraseñas con la autenticación multifactor (MFA), que usa algo que tiene,  algo que sabes o algo que eres.

El nivel de confianza ganado a través de pasos de verificación adicionales determina parcialmente si se otorga el acceso y a qué nivel específico.

Los principios Zero Trust se aplican independientemente del tipo de usuario (usuario final, usuario privilegiado, TI subcontratado, socio o cliente) o el recurso al que se accede (aplicación o infraestructura). Las decisiones de acceso deben ser adaptativas y dinámicas.

##### 2 | Verificar el dispositivo
Para lograr Zero Trust Security, los controles preventivos centrados en la identidad deben extenderse hasta el endpoint. 

Al igual que con los usuarios, no se puede confiar en los dispositivos sin verificar. La verificación de un dispositivo implica que el usuario verificado inscriba su dispositivo para que se reconozca.

Si el usuario solicita acceso desde un dispositivo registrado que usa todos los días, tiene un cierto nivel de confianza. Si intentan acceder a los servicios desde una estación de trabajo en un cibercafé que nunca han usado antes, la confianza está fuera.

La verificación de los dispositivos también implica asegurarse de que solo se permita el acceso a los dispositivos si cumplen con ciertos requisitos de seguridad: ¿Han sido registrados? ¿Se ajustan las configuraciones del dispositivo a las políticas de la empresa, como el cifrado de disco, la protección contra virus y los parches actualizados?

##### 3 | Limitar el acceso y los privilegios
Los privilegios de usuario deben ser administrados con mucho control. Las partes malintencionadas frecuentemente se dirigen al personal con privilegios administrativos para obtener control sobre los sistemas de negocio.

Primero, con Zero Trust Security, es importante limitar el movimiento lateral dentro de todos los recursos, como servidores y estaciones de trabajo, limitando a los usuarios solo al acceso que necesitan para realizar sus trabajos.

La segunda es la autorización en aplicaciones de negocios. Debido a que estas aplicaciones a menudo contienen grandes cantidades de datos críticos y debido a que generalmente son accedidas por más usuarios dentro de la organización, pueden ser objetivos más fáciles para los atacantes. Por lo tanto, es igualmente importante proporcionar solo acceso suficiente dentro de cada aplicación para que los usuarios hagan su trabajo.

Supongamos que un atacante inicia sesión en una base de datos utilizando credenciales robadas. Los privilegios del usuario se limitan al mínimo, el atacante también se limitará a lo que pueden acceder. Cuanto más críticos son los datos, menos privilegios, y con un mayor uso de MFA para garantizar la identidad.

##### 4 | Aprende y adapta
Al igual que Gartner ha sugerido con su enfoque CARTA, Zero Trust Security debe mejorar continuamente mediante el aprendizaje y la adaptación. 

La información sobre el usuario, el endpoint, las aplicaciones o el servidor, las políticas y todas las actividades relacionadas con ellos se pueden recopilar y enviar a un conjunto de datos que alimente el aprendizaje automático.

Luego, el sistema puede reconocer automáticamente comportamientos fuera de lo común, como un usuario que intenta acceder a los recursos desde una ubicación inusual, lo que inmediatamente provoca una señal de advertencia que puede requerir una segunda forma de autenticación, todo dependerá de las políticas.

Los análisis de comportamiento se utilizan para determinar el nivel de riesgo de las transacciones individuales y decidir en tiempo real si las permite o no, proporcionando servicios de identidad con información clave que podemos indicar a los administradores.

#### ¿De qué se compone Zero Trust?
El modelo de seguridad Zero Trust actual se ha ampliado. Sus principios se han implementado de muchas maneras, incluida la arquitectura Zero Trust (ZTA), el acceso de red Zero Trust (ZTNA) y Zero Trust Edge (ZTE). La seguridad Zero Trust también se denomina a veces "seguridad sin perímetro".

Zero Trust no se trata de una sola tecnología discreta, sino que la arquitectura Zero Trust utiliza numerosas tecnologías y principios diferentes para abordar los desafíos de seguridad comunes a través de técnicas preventivas. Estos componentes están diseñados para proporcionar protección avanzada contra amenazas a medida que las fronteras entre el trabajo y la vida personal se desdibujan, y tener una plantilla remota cada vez más distribuida se convierte en lo habitual.

##### Capacidades de acceso de red Zero Trust
1. Se controlan los flujos de red entre todos los activos.
2. Se comprueba la identidad y se proporciona acceso a la nube
3. Autenticación y autorización, como la autenticación multifactor (MFA)
4. Acceso a aplicaciones frente al acceso a toda la red
5. Acceso del usuario a todas las aplicaciones con privilegios mínimos (IaaS, SaaS y locales).
6. Eliminación de la VPN.
7. Inserción de servicios.
8. Seguridad en el borde de Internet.
9. Mejora del rendimiento de las aplicaciones.
10. Mejora de la estrategia de seguridad frente a amenazas avanzadas.

#### Ventajas clave de la arquitectura Zero Trust
Una arquitectura Zero Trust funciona a la perfección para los usuarios, ayuda a protegerse de los ciberataques y simplifica los requisitos de infraestructura. Los distintos componentes de la arquitectura Zero Trust pueden:

##### Garantizar la confianza en la red y frenar los ataques maliciosos
Los equipos de TI tienen que asegurarse de que los usuarios y los dispositivos pueden conectarse de forma segura a Internet, independientemente de su ubicación de conexión, y sin las complejidades asociadas a los enfoques heredados. También deben identificar, bloquear y mitigar proactivamente las amenazas dirigidas, como el malware, ransomware, phishing, exfiltración de datos DNS y ataques avanzados de día cero para los usuarios. Los modelos de seguridad Zero Trust pueden mejorar las estrategias de seguridad, a la vez que reducen el riesgo de sufrir ataques de malware.

##### Proporcionar acceso seguro a las aplicaciones para personas empleadas y partners
Tecnologías de acceso tradicionales, como VPN, se basan en principios de confianza anticuados, que son especialmente vulnerables debido al robo de credenciales de los usuarios y las consecuentes filtraciones de datos. Los equipos de TI deben replantearse sus tecnologías y su modelo de acceso para garantizar la seguridad de la empresa y que todos los usuarios, incluidos terceros, puedan seguir accediendo rápida y fácilmente. Los modelos de seguridad Zero Trust ayudan a reducir los riesgos y las complejidades, así como a ofrecer una experiencia de usuario uniforme.

##### Reduzca la complejidad y ahorre en recursos de TI
El acceso y la seguridad empresarial son aspectos complejos y en constante cambio. Hacer cambios con las tecnologías empresariales tradicionales suele llevar días (y requiere muchos componentes de hardware y software) y acaparar recursos valiosos. Aplicar un modelo de seguridad Zero Trust puede reducir la complejidad de la arquitectura.

##### Por qué es necesario un modelo de seguridad Zero Trust
En resumen, la plantilla moderna se está volviendo cada vez más móvil, con acceso a aplicaciones desde varios dispositivos fuera del perímetro de la empresa. En el pasado, muchas empresas adoptaron un modelo basado en comprobar primero la identidad y, a continuación, confiar. Por tanto, si alguien tenía las credenciales de usuario correctas, podía acceder a cualquier sitio web, aplicación o dispositivo que desease. Esto ha traído consigo un mayor riesgo de exposición, difuminando lo que tradicionalmente había sido la zona de control empresarial de confianza y dejando a muchas organizaciones expuestas a ataques de filtración de datos, malware y ransomware. Ahora es necesario proteger las aplicaciones, los datos, los usuarios y los dispositivos allá donde se encuentren dentro de infraestructuras digitales específicas.

##### Razones convincentes para emplear un modelo Zero Trust
1. Los usuarios, los dispositivos, los datos y las aplicaciones se están trasladando fuera del perímetro de la empresa y de la zona de control; se están alejando de los centros de datos tradicionales.
2. Los nuevos requisitos empresariales, impulsados por la transformación digital, incrementan el riesgo a la exposición.
3. El enfoque "confiar, pero verificar" ya no es una opción, dado que las amenazas avanzadas ahora acceden al perímetro de la empresa.
4. Los perímetros tradicionales son complejos, incrementan el riesgo y ya no son adecuados para los modelos de negocio actuales.
5. Para ser competitivas, las empresas necesitan una arquitectura de red Zero Trust que sea capaz de proteger los datos empresariales, independientemente de la ubicación de los usuarios y los dispositivos, al tiempo que garantiza el funcionamiento rápido y óptimo de las aplicaciones.


### 434.B7E2.2_Hardening-Baselines_&_Estándares

### Baselines y estándares de Hardening
![[434.B7E2_baselines.png]]

Una línea de base de seguridad es un grupo de ajustes de configuración recomendados que buscan incrementar la seguridad de los sistemas informáticos.

Todas las organizaciones se enfrentan a amenazas de seguridad. Sin embargo, los tipos de amenazas a la seguridad que más preocupan a una organización pueden ser completamente diferentes a los de otra.

Por ejemplo, una empresa de comercio electrónico puede centrarse en la protección de sus aplicaciones web orientadas a Internet, mientras que un hospital puede centrarse en la protección de la información confidencial de los pacientes. Lo único que todas las organizaciones tienen en común es la necesidad de mantener sus aplicaciones y dispositivos seguros. Estos dispositivos deben cumplir con las normas de seguridad (o líneas de base de seguridad) definidas por la organización.

#### ¿Por qué son necesarias las líneas de base de seguridad?
Las líneas de base de seguridad son un beneficio esencial para los clientes porque reúnen el conocimiento de expertos, los socios y los clientes.

Por ejemplo, hay más de 8.000 configuraciones de directivas de grupo para Windows 10 y los distintos productos de Microsoft. De todas estas configuraciones, solo algunas están relacionadas con la seguridad, cuyo papel para asegurar este software es fundamental. Esto lleva a las organizaciones modernas, a estudiar muy de cerca el panorama de las amenazas a la seguridad que puede amenazarles, el cual también está en constante evolución, y los profesionales de TI y los responsables de las políticas deben mantenerse al día con dichas amenazas con el fin de realizar los cambios necesarios en la configuración de seguridad para ayudar a mitigar estas amenazas. 

En este sentido, las baselines ayudan a las organizaciones crear implementaciones más rápidas y facilitar la gestión de los productos y su seguridad. Básicamente, toda la comunidad interesada en un producto ayuda a crear dichas baselines y de esta forma crear un estándar de seguridad aplicable a casos genéricos de acuerdo a las necesidades y el nivel de protección deseado. 

#### Principios de las baselines
Nuestras recomendaciones siguen un enfoque racionalizado y eficiente para las definiciones de líneas de base. La base de ese enfoque es esencialmente:
1. Las líneas de base están diseñadas para organizaciones bien gestionadas y preocupadas por la seguridad en las que los usuarios finales estándar no tienen derechos administrativos.
2. Una línea de base aplica una configuración solo si mitiga una amenaza de seguridad actual y no causa problemas operativos que sean peores que los riesgos que mitigan.
3. Una línea de base impone una configuración por defecto solo si es probable que un usuario autorizado la establezca en un estado inseguro:
4. Si una persona no administradora puede establecer un estado inseguro, aplique el valor por defecto.
5. Si la configuración de un estado inseguro requiere derechos administrativos, aplique el valor por defecto solo si es probable que un administrador mal informado elija mal.

#### Baselines dentro de la industria
1. Red Hat Baselines
2. Cis Benchmark
3. Security Technical Implementation Guide (STIG)
4. National Checklist Program (NCP)

##### 1 | Red Hat Baselines
Red Hat es considerada una de las grandes empresas del mundo de software libre que participa de forma activa dentro de este ecosistema, impulsando el desarrollo de soluciones dentro del kernel Linux y desktops como el proyecto GNOME y systemd.

Parte de ese desarrollo se ve claramente reflejado en Red Hat Linux (RHEL), una distribución centrada en ofrecer un sistema completo para empresas y que viene acompañado de una serie de recomendaciones y baselines de seguridad conocidas como Red Hat Security Baselines, que se ajustan a cada versión del sistema operativo que se encuentra en desarrollo y mantenimiento.

Actualmente, RHEL se encuentra en sus versiones 8 y 9, y puedes acceder a las baselines básicas de seguridad en la documentación online de este sistema operativo ([enlace para la versión 9](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/security_hardening/index)). 

![[434.B7E2_redhat.png]]

##### 2 | CIS Benchmark
CIS Benchmark son una serie de baselines de seguridad publicados por el Center for Internet Security (CIS). 

Estas baselines son consideradas como las mejores prácticas documentadas del sector para configurar de forma segura los sistemas, el software y las redes de TI. En la actualidad, hay más de 140 puntos de referencia del CIS, que abarcan siete categorías tecnológicas básicas. Los puntos de referencia del CIS se desarrollan a través de un proceso único basado en el consenso en el que participan comunidades de profesionales de la ciberseguridad y expertos en la materia de todo el mundo, cada uno de los cuales identifica, perfecciona y valida continuamente las mejores prácticas de seguridad dentro de sus áreas de interés.

[CIS](https://www.cisecurity.org/cis-benchmarks/) es una organización sin ánimo de lucro creada en octubre de 2000. El CIS está impulsado por una comunidad global de TI con el objetivo común de identificar, desarrollar, validar, promover y mantener las mejores prácticas de soluciones para la ciberdefensa. A lo largo de los años, el CIS ha producido y distribuido varias herramientas y soluciones gratuitas para empresas de todos los tamaños, diseñadas para reforzar su preparación en materia de ciberseguridad.

El CIS es más conocido por su publicación CIS Controls, una guía completa de 20 salvaguardias y contramedidas para una ciberdefensa eficaz. Los Controles CIS proporcionan una lista de verificación priorizada que las organizaciones pueden implementar para reducir significativamente su superficie de ciberataque. Las referencias de CIS hacen referencia a estos controles cuando elaboran recomendaciones para una configuración de sistemas más segura.

Cada punto de referencia CIS incluye múltiples recomendaciones de configuración basadas en uno de los dos niveles de perfil. Los perfiles de referencia de nivel 1 cubren configuraciones de nivel básico que son más fáciles de implementar y tienen un impacto mínimo en la funcionalidad del negocio. Los perfiles de referencia de nivel 2 están pensados para entornos de alta seguridad y requieren más coordinación y planificación para implementarlos con una interrupción mínima del negocio.

Hay siete (7) categorías principales de puntos de referencia CIS:
1. **Los puntos de referencia de los sistemas operativos:**  
    Cubren las configuraciones de seguridad de los sistemas operativos principales, como Microsoft Windows, Linux y Apple OSX. Incluyen directrices de buenas prácticas para las restricciones de acceso local y remoto, perfiles de usuario, protocolos de instalación de controladores y configuraciones de navegadores de Internet.
2. **Los puntos de referencia del software de servidor:**  
    Cubren las configuraciones de seguridad del software de servidor más utilizado, como Microsoft Windows Server, SQL Server, VMware, Docker y Kubernetes. Estos puntos de referencia incluyen recomendaciones para configurar los certificados PKI de Kubernetes, la configuración del servidor API, los controles de administración del servidor, las políticas de vNetwork y las restricciones de almacenamiento.
3. **Los puntos de referencia del proveedor de la nube:**  
    Abordan las configuraciones de seguridad para Amazon Web Services (AWS), Microsoft Azure, Google, IBM y otras nubes públicas populares. Incluyen directrices para configurar la gestión de la identidad y el acceso (IAM), los protocolos de registro del sistema, las configuraciones de red y las salvaguardias de cumplimiento normativo.
4. **Los puntos de referencia de los dispositivos móviles:**  
    Abordan los sistemas operativos móviles, incluidos iOS y Android, y se centran en áreas como las opciones y los ajustes de los desarrolladores, las configuraciones de privacidad del sistema operativo, los ajustes del navegador y los permisos de las aplicaciones.
5. **Los puntos de referencia de dispositivos de red:**  
    Ofrecen directrices de configuración de seguridad generales y específicas del proveedor para los dispositivos de red y el hardware aplicable de Cisco, Palo Alto Networks, Juniper y otros.
6. **Los puntos de referencia del software de escritorio:**  
    Cubren las configuraciones de seguridad para algunas de las aplicaciones de software de escritorio más utilizadas, como Microsoft Office y Exchange Server, Google Chrome, Mozilla Firefox y Safari Browser. Estos puntos de referencia se centran en la privacidad del correo electrónico y la configuración del servidor, la gestión de dispositivos móviles, la configuración del navegador por defecto y el bloqueo de software de terceros.
7. **Los puntos de referencia de los dispositivos de impresión multifunción:**  
    Describen las mejores prácticas de seguridad para la configuración de impresoras multifunción en entornos de oficina y abarcan temas como la actualización del firmware, las configuraciones TCP/IP, la configuración del acceso inalámbrico, la gestión de usuarios y el uso compartido de archivos.

![[434.B7E2_cis.png]]

##### 3 | Security Technical Implementation Guide (STIG)
Security Technical Implementation Guide (STIG) o Guía de Implementación Técnica de Seguridad (STIG), es un estándar de configuración que consiste en requisitos de ciberseguridad para un producto específico. 

El uso de las STIG permite una metodología para asegurar los protocolos dentro de las redes, servidores, ordenadores y diseños lógicos para mejorar la seguridad general. Estas guías, cuando se aplican, mejoran la seguridad del software, el hardware y las arquitecturas físicas y lógicas para reducir aún más las vulnerabilidades.

Las STIGs pueden provenir de varias organizaciones o autoridades especializadas en seguridad, sin embargo, las STIGs más conocidas en este caso provienen del DoD Cyber Exchange, un programa del Departamento de Estado de los Estados Unidos que reúne baselines de seguridad bien documentadas aplicables a varios sistemas y software. Por ejemplo, hay STIGs aplicables a software como Apache Web Server, Windows Server (aplica al servidor y la seguridad de servicios como Active Directory, DNS AD, entre otros), Adobe Acrobat, Firefox, Chrome (y derivados), Android e iOS, sistemas operativos como AIX, FreeBSD y varios distros GNU/Linux.

![[434.B7E2_stig.png]]

##### 4 | National Checklist Program (NCP)
El National Checklist Program (NCP) o Programa Nacional de Listas de Comprobación (NCP), es un programa definido por el National Institute of Standards and Technology (NIST), con el fin de cumplir con el estándar [NIST SP 800-70](https://csrc.nist.gov/publications/detail/sp/800-70/rev-4/final). 

El NCP es el repositorio del gobierno de los Estados Unidos de listas de comprobación de seguridad disponibles públicamente (o puntos de referencia) que proporcionan una guía detallada de bajo nivel para establecer la configuración de seguridad de los sistemas operativos y las aplicaciones.

NCP proporciona metadatos y enlaces a listas de comprobación de varios formatos, incluidas las listas de comprobación que se ajustan al Protocolo de Automatización de Contenidos de Seguridad (SCAP). El SCAP permite que los productos de seguridad validados realicen automáticamente la comprobación de la configuración utilizando las listas de comprobación del NCP. Para más información sobre el PNC, visite la página de información o el glosario de términos. Tenga en cuenta que los campos de búsqueda actuales se han ajustado para reflejar el NIST SP 800-70 Revisión 4.

![[434.B7E2_ncp.png]]


### 435.B7E2.3_Hardening_Windows

### Hardening en Windows
El Hardening en sistemas Windows puede ser una tarea titánica debido a la complejidad de este sistema y los miles de parámetros que se pueden ajustar.

Sin embargo, es una tarea que debe realizarse a los fines de cumplir con criterios de seguridad que permitan garantizar la integridad y confiabilidad de los sistemas.

En la unidad anterior, dedicada a los baselines, pudimos conocer algunas guías de seguridad que pueden ayudarte a automatizar esta tarea, algo útil cuando trabajas en organizaciones grandes donde se deben de administrar decenas o cientos de equipos. Es por ello, que en esta sección verás cuáles son los puntos que debes tener en cuenta en el Hardening de este sistema operativo para cumplir con medidas mínimas recomendadas de seguridad.

#### ¿Qué son las Baselines de seguridad de Windows?
Windows y Windows Server están diseñados pensando en la seguridad. Microsoft asegura ciertos aspectos y también proporciona a las organizaciones controles que permiten una configuración de seguridad granular.

Para ayudar a las organizaciones a aprovechar adecuadamente los controles de seguridad, Microsoft proporciona líneas básicas de seguridad que ofrecen orientación.

Cada línea de base de seguridad de Windows es un grupo de ajustes de configuración basados en los comentarios de los ingenieros de seguridad de Microsoft, así como de grupos de productos, clientes y socios. Estas líneas básicas de seguridad están disponibles en un formato consumible, incluso como copias de seguridad de objetos de directiva de grupo.

Las Baselines de Seguridad de Windows pueden ayudar a las organizaciones a garantizar que las configuraciones de dispositivos y usuarios que ya se han configurado cumplen con las líneas básicas de Windows. También puede ayudar a establecer los parámetros de configuración para las nuevas instalaciones del sistema operativo, por ejemplo, cuando se utiliza Microsoft Endpoint Configuration Manager, Microsoft Intune o Group Policy

Las líneas básicas de seguridad están disponibles en el [Centro de descargas de Microsoft](https://www.microsoft.com/en-us/download/details.aspx?id=55319).

#### Hardening en Windows, lista de comprobación
##### Configuración de usuarios de Windows
Siga estas directrices para reducir los riesgos de las cuentas de usuario privilegiadas en Windows:
1. **Desactive el administrador local predeterminado (conocido como Admin):**  
    Normalmente no es necesario y es un objetivo popular para los atacantes.
2. **Configure una cuenta de administrador personalizada:**  
    Puede ser una cuenta de Active Directory (AD) del dominio o una cuenta local del grupo de administradores.
3. **Prefiera ejecutar como una cuenta de usuario normal:**  
    Para reducir la posibilidad de que la cuenta se vea comprometida, conéctese al servidor utilizando una cuenta de usuario normal y, cuando necesite realizar operaciones que requieran privilegios administrativos, solicite la elevación utilizando "Ejecutar como" (el equivalente a sudo en Windows).

##### #### Configuración de la red de Windows
Tome las siguientes precauciones para proteger una máquina Windows de los ataques de red:
1. **Coloque la máquina detrás del cortafuegos:**  
    Las instancias de Windows y Windows Server en producción deben ejecutarse siempre en un segmento de red debidamente protegido.
2. **Use DNS redundante:**  
    Configure dos o más servidores DNS y verifique la resolución de nombres mediante nslookup. De esta manera podrá asegurarse de que exista siempre una conexión a Internet. 
3. **Verifique los registros DNS:**  
    Asegúrese de que el servidor tiene un registro A y un registro PTR para las búsquedas DNS inversas.
4. **Asegúrese de usar servidores DNS con DNS Over HTTPS:** Para cifrar la conexión y con verificación por DNSSEC. Esto le asegurará que nadie pueda interferir con este sistema y podrá validar las direcciones otorgadas por el servicio. 
5. **Desactivar los servicios de red:**  
    Cualquier servicio que el servidor no esté utilizando realmente, como IPv6, debe desactivarse para reducir la superficie de ataque.

##### Configuración de servicios de Windows
Siga estas directrices para minimizar el riesgo de los servicios que se ejecutan en Windows y Windows Server:
1. **Desactive los servicios no utilizados:**  
    Muchos servicios que se ejecutan por defecto en Windows Server pueden no ser necesarios en su caso de uso específico, y deben ser desactivados. Desactive cualquier servicio que no sea necesario para la funcionalidad básica. Preste especial atención a Windows Server 2008 y 2003, que tienen un mayor número de servicios redundantes.
2. **Limite el contexto de seguridad:**  
    Cada servicio se ejecuta como una cuenta de usuario específica. Por defecto, estas son las cuentas de Servicio de red, Sistema local o Servicio local. Para los servicios de aplicaciones y usuarios sensibles, configure cuentas para cada servicio y limite los privilegios al mínimo necesario para cada servicio. Esto limita la capacidad de escalada de privilegios y el movimiento lateral. Esto es equivalente a crear usuario/grupos en instalaciones dentro de sistemas GNU/Linux. 

##### Configuración del Protocolo de Tiempo de Red (NTP)
El inicio de sesión de Windows y otras funciones que aprovechan la seguridad de Kerberos dependen de la precisión de las horas NTP. 

Incluso una pequeña diferencia horaria puede interrumpir la funcionalidad. Para evitar la interrupción del servicio, asegúrese de que:
1. Los servidores dentro de los dominios sincronizan automáticamente la hora con el controlador del dominio.
2. Los servidores independientes se sincronizan con una fuente de tiempo externa.
3. Los controladores de dominio se sincronizan con un servidor de hora de forma continua

##### Registros de eventos centralizados
Los sistemas Windows generan varios registros, que pueden configurarse para ser más o menos detallados. 

Los registros son una forma importante de obtener visibilidad sobre las operaciones del servidor con fines de mantenimiento y seguridad. Para proporcionar un acceso cómodo a los registros de las instancias de Windows de una organización, utilice un servidor syslog central y asegúrese de que dispone de las siguientes capacidades:
1. Capacidad para asignar categorías a registros o entradas específicas.
2. Permitir la búsqueda de texto completo y la consulta de datos de registro.
3. Integrar el registro con herramientas de corrección para permitir la respuesta automatizada a los errores.

##### Ajustes adicionales de seguridad para Windows 
Adicional a esto, puede reforzar la seguridad de Windows de la siguiente forma:

###### Aproveche las herramientas de seguridad integradas en Windows. 
Por ejemplo, en Windows 10 y 11, el sistema viene con varias herramientas de seguridad integradas, entre ellas: 
1. **Windows Defender Advanced Threat Protection:**  
    Un sistema de seguridad avanzado que incluye protección antimalware de última generación, así como protección contra exploits, reducción automatizada de la superficie de ataque, control de aplicaciones y aislamiento basado en hardware.
2. **Microsoft SmartScreen:**  
    Analiza las descargas y bloquea la ejecución de cargas útiles maliciosas.
3. **Windows Sandbox:**  
    Permite a los usuarios instalar aplicaciones no fiables en un entorno seguro y aislado.
4. **HVCI y VBS:**  
    Medidas de seguridad que garantizan la seguridad y aislamiento del kernel de Windows para evitar vulnerabilidades en el mismo. 
5. **Windows Device Guard:**  
    Una serie de protecciones a nivel de hardware y software que garantizan que el sistema se ejecute solo en medios de confianza (usa TPM, Secure Boot y BitLocker para garantizar seguridad y criptografía de alto nivel para el sistema). 
6. **Windows Mitigations Framework:**  
    Una serie de opciones configurables que permiten al sistema habilitar opciones de seguridad y mitigación de vulnerabilidades. Debe usarse con cuidado porque hay software que no está construido para soportar estas mitigaciones llevando a malos funcionamientos (ej: Discord, Slack, Zoom, entre otros)

###### Gestión de aplicaciones
Es muy recomendable configurar Windows para que solo permita la instalación de aplicaciones aprobadas desde repositorios de software controlados o mercados de aplicaciones.

Puede hacerlo configurando la opción "Permitir solo aplicaciones de la tienda" en Aplicaciones y características, o utilizando las políticas de integridad del código de Windows Defender.

Esto puede evitar que los atacantes envíen malware por correo electrónico a los usuarios, que los convenzan para que descarguen e instalen malware, o que desplieguen malware a través de descargas no autorizadas o enlaces engañosos en sitios web maliciosos. Tenga en cuenta que incluso si requiere acceso administrativo en el equipo local para instalar software, los atacantes pueden eludirlo con ingeniería social.

###### Control de aplicaciones
Muchos vectores de ataque se basan en la ejecución de código malicioso, aunque no esté instalado en el dispositivo del usuario.

Las listas blancas y negras de ejecutables en Windows 10 pueden ser eficaces para prevenir estos ataques. Muchas de las mejores prácticas de seguridad aconsejan crear una nueva lista blanca de archivos que se pueden ejecutar en las máquinas de los usuarios finales, sin depender de las listas de los proveedores de aplicaciones o de los archivos existentes en la máquina.

Sin embargo, en los entornos empresariales reales, puede ser difícil crear dicha lista blanca y mantenerla en un gran número de máquinas. Las listas blancas también tienden a ser demasiado restrictivas, perjudicando la productividad de los usuarios.

###### Desactivar el acceso remoto
Windows viene con Microsoft Remote Desktop que proporciona acceso remoto a la máquina de un usuario. 

Esta función suele ser utilizada por los atacantes para obtener el control remoto de los dispositivos de los usuarios, instalar malware y robar información. El Escritorio Remoto está desactivado por defecto, pero en caso de que los usuarios lo habiliten, es importante asegurarse de que está desactivado, excepto cuando se necesite para un uso legítimo y aprobado.

###### PowerShell
PowerShell es un lenguaje de scripting que es extremadamente poderoso en manos de un atacante. 

Siga estas directrices para proteger los sistemas contra los ataques de PowerShell:
1. Elimine la versión 2.0 o anterior de PowerShell, que tenía vulnerabilidades de seguridad
2. Establezca PowerShell en modo de lenguaje restringido
3. Habilitar el registro de PowerShell para proporcionar una pista de auditoría
4. Establecer una política de ejecución - una característica de seguridad que especifica bajo qué condiciones PowerShell cargará archivos de configuración y ejecutará scripts

###### Habilitar las actualizaciones automáticas
Implantar las actualizaciones de seguridad de Microsoft en todos los dispositivos de los usuarios de forma inmediata.

Automatice y aplique el despliegue de las actualizaciones regulares de Windows, si es posible, sin la participación del usuario.

###### Deshabilitar el soporte para SMBv1 y fortalecer el sistema de autenticación SMB
Otra medida de seguridad que es desactivar el soporte para SMBv1 (un viejo protocolo ya en desuso) y la de fortalecer la seguridad de autenticación (requiriendo cifrado y firmado digital) para las conexiones remotas de SMBv2 y SMBv3.

##### Pruebas y Auditoría de Hardening
Ahora bien, las medidas mencionadas son algunas de las medidas básicas para asegurar un sistema Windows, siendo las baselines de Windows la mejor forma de aplicar esto. 

En las baselines todos los valores de seguridad recomendados se encuentra ya configurados quedando solo aplicar los mismos según sea nuestro requerimiento. 

Para este ejemplo práctico usaremos Windows 11 y un pequeño aplicativo de nombre [HardeningKitty](https://github.com/scipag/HardeningKitty) creado por los especialistas de seguridad [Scip AG](https://www.scip.ch/), quienes actualizan el mismo con las baselines de seguridad de Windows de forma periódica y nos facilitan la aplicación de las mismas. Este Windows 11 sin modificación de seguridad viene con un score de auditoría de HardeningKitty de 1,8 puntos, bastante bajo y con la aplicación del baseline elevaremos esa seguridad. 

![[435.B7E2_elevaremos.png]]

Para usar esta herramienta todo lo que debes hacer es descargar la misma desde GitHub y descomprimir su contenido. Una vez realizado esto, te recomendamos instales la última versión de PowerShell (la versión estable), algo que puedes hacer desde este [enlace](https://docs.microsoft.com/es-es/powershell/scripting/install/installing-powershell-on-windows?view=powershell-7.2). 

Antes de empezar debes saber que HardeningKitty viene con varias baselines de Microsoft, que puedes ver en la siguiente imagen:

![[435.B7E2_HardeningKitty.png]]

- De estas listas deberás elegir la que se adapte a tu sistema operativo, en este caso, usaremos la lista
**finding_list_msft_security_baseline_windows_11_21h2_machine.csv**
- Ya que estaremos usando Windows 11 para esta prueba. Así, una vez descargada e instalada la última versión de PowerShell y ubicados en el directorio de HardeningKitty, simplemente ejecutaremos este comando desde una PowerrShell con permisos administrativos:
**Import-Module .\Invoke-HardeningKitty.ps1**
- Este nos permitirá cargar el módulo y comenzar a usarlo, y luego haremos el siguiente comando:
**Invoke-HardeningKitty -Mode Config -Backup**
- Este comando nos permitirá hacer un respaldo de la configuración de seguridad actual, un paso especialmente útil si por alguna razón queremos volver a la configuración por defecto que está desplegada en nuestro sistema. El resultado será un CSV que recomendamos guardes en un lugar seguro para volver al estado anterior de seguridad si lo deseas. 
- Seguidamente procedes a ejecutar el comando:
**Invoke-HardeningKitty -Mode HailMary -Log -Report -FileFindingList
.\lists\
finding_list_msft_security_baseline_windows_11_21h2_machine.csv**
- Este comando lo que hará es habilitar el modo de enforce de medidas de seguridad que están descritas en la lista descrita (en este caso, la lista es la que vemos en el archivo **finding_list_msft_security_baseline_windows_11_21h2_machine.csv**) y de esa manera toda la baseline de ese archivo será configurada en el sistema. Al finalizar el proceso ya habrás terminado de configurar la baseline en Windows. 
- En este punto, puedes hacer una nueva auditoria en vivo usando el comando:
**Invoke-HardeningKitty -EmojiSupport**
- Y con ello obtendremos el nuevo perfil de seguridad:

![[435.B7E2_perfil.png]]

Con ello podemos ver que las medidas de seguridad han sido aplicadas y nuestro sistema muestra un score de 5,53 (de 6 puntos totales) lo que ya nos muestra que hemos elevado de forma exitosa la seguridad del mismo. 

Si bien, esto no hace de Windows un sistema invulnerable, las medidas de seguridad hacen del mismo un espacio mucho más seguro de usar en ambientes empresariales. 

Esto no solo aplica a Windows, HardeningKitty puede usarse para aplicar STIGS y listas de seguridad para cualquier software (Firefox, Chrome, Adobe Suite, Office, y cualquiera con soporte), incluso en Windows Server, por lo que es una herramienta sencilla y muy potentes para asegurar sistemas.


### 436.B7E2.4_Hardening_Linux

### Hardening en GNU/Linux
Al igual que en Windows, el Hardening es sistemas operativos GNU/Linux es una tarea ardua que lleva a la configuración de varios archivos y configuraciones con el fin de alcanzar la configuración de seguridad deseada.

En tal caso, con el fin de alcanzar una configuración de seguridad básica para GNU/Linux estas son algunas buenas recomendaciones que puedes realizar con el fin de alcanzar el nivel deseado.

![[436.B7E2_hardening.png]]

#### Medidas básicas de Hardening en GNU/Linux
##### Control de usuarios y grupos
Una de las principales medidas de seguridad en GNU/Linux es el control de los usuarios y grupos que tienen acceso y permisos dentro del sistema. 

Utilice los comandos useradd / usermod para crear y mantener cuentas de usuario. Asegúrate de tener una política de contraseñas buena y fuerte. 

Por ejemplo, una buena contraseña incluye al menos 8 caracteres de longitud y una mezcla de alfabetos, números, caracteres especiales, letras mayúsculas y minúsculas, etc. Lo más importante es que elijas una contraseña que puedas recordar. Configure pam_cracklib.so (una librería para chequear contraseñas) para hacer cumplir la política de contraseñas que haya decidido aplicar sobre el sistema. 

##### Configurar el tiempo de validez de las contraseñas
El comando chage cambia el número de días entre los cambios de contraseña y la fecha del último cambio de contraseña. 

Esta información es utilizada por el sistema para determinar cuándo un usuario debe cambiar su contraseña. El archivo /etc/login.defs define la configuración específica del sitio para el conjunto de contraseñas en la sombra, incluyendo la configuración del envejecimiento de la contraseña. 

![[436.B7E2_envejecimiento.png]]

Desde este documento puedes cambiar configuraciones tan relevantes como la validez temporal de las contraseñas, el mask por defecto de los usuarios (para que se asignen determinados permisos a los documentos creados por el usuario), entre otras variables de seguridad.

- En todo caso, para revisar el status de un usuario puedes usar el comando:
**### chage -l nombredeusuario**
- Además, puedes usar el comando chage para cambiar estos parámetros directamente sobre el archivo /etc/shadow (que sirve de base de datos para este tipo de información) usando la siguiente línea de comando:
**### chage -M 120 -m 7 -W 7 userName**

Esto indica que:
1. La contraseña solo será válida por 120 días.
2. La existencia mínima de la contraseña será de 7 días y antes de esto no se puede cambiar. 
3. Un periodo de advertencia de 7 días, para que realices el cambio de la misma y no te tome un bloqueo del sistema porque la contraseña se ha vencido.

##### Restringir el uso de contraseñas anteriores en Linux
Puede evitar que todos los usuarios utilicen o reutilicen las mismas contraseñas anteriores en Linux. 

El parámetro “remember” del módulo pam_unix se puede utilizar para configurar el número de contraseñas anteriores que no se pueden reutilizar.

##### Bloqueo de cuentas de usuario tras fallos en el inicio de sesión
En GNU/Linux se puede utilizar el comando faillog para mostrar los registros de faillog o para configurar los límites de fallos de inicio de sesión. 

faillog formatea el contenido del registro de fallos de la base de datos /var/log/faillog / archivo de registro. También se puede utilizar para mantener los contadores y límites de fallos. Para ver los intentos de inicio de sesión fallidos, introduzca el comando:
**### faillog**
Para desbloquear una cuenta después de los fracasos de inicio de sesión, ejecute:
**### faillog -r -u nombredeusuario**
Aunque también puede usar el comando passwd para bloquear o desbloquear cuentas:
**### passwd -l nombredeusuario- Bloquea la cuenta del usuario**
**### passwd -u nombredeusuario- Desbloquea la cuenta del usuario**

##### Asegúrese de que ninguna cuenta que no sea root tenga el UID a 0
Solo la cuenta root tiene UID 0 con permisos completos para acceder al sistema. Escriba el siguiente comando para mostrar todas las cuentas con UID establecido en 0:
**### awk -F: '($3 == "0") {print}' /etc/passwd**
Solo debería ver una línea como la siguiente:

![[436.B7E2_bash.png]]

##### Desactivar el inicio de sesión de root
Nunca inicie sesión como usuario root, de hecho, desactive esa cuenta y en su lugar use una cuenta con permisos limitados y _Sudo_ (Super User Do) para administrar el sistema.

Sudo mejora enormemente la seguridad del sistema sin compartir la contraseña de root con otros usuarios y administradores. También proporciona funciones sencillas de auditoría y seguimiento.

Para bloquear root, basta con ejecutar el comando: 
**### passwd -l root- Bloquea la cuenta del usuario**

Con eso habrá deshabilitado la cuenta de root y solo podrás usar Sudo como medio para administrar el sistema. En caso de emergencia, puedes recuperar el acceso al sistema por medio de un chroot al sistema (iniciando con una distro en modo live y montando el sistema sobre un root externo creado por el chroot). 

##### Seguridad del computador físico
Debe proteger el acceso a la consola física de los servidores Linux. Configurar la BIOS y deshabilitar el arranque desde dispositivos externos como DVDs / CDs / USB pen. Configure la BIOS y la contraseña del cargador de arranque GRUB para proteger estas configuraciones.

Todas las cajas de producción deben estar bloqueadas en los IDC (Centros de Datos de Internet) y todas las personas deben pasar algún tipo de control de seguridad antes de acceder a su servidor. 

##### Desactive los servicios Linux no deseados
Desactive todos los servicios y demonios innecesarios (servicios que se ejecutan en segundo plano). Es necesario eliminar todos los servicios no deseados del inicio del sistema.

Ya que la mayoría de distribuciones GNU/Linux usan systemd, basta con ejecutar el comando:
**### systemctl list-unit-files --type=service**

Para obtener una lista completa de los servicios que se ejecutan en el computador, tal como se muestra en la siguiente imagen:

![[436.B7E2_servicios.png]]

Revisa dicha lista, cualquier cosa que no esté usando, desactívela usando el comando:
- Para detener el servicio de impresora (no tenemos)
**### systemctl stop cups.service-**
- Enmascara el servicio para que no inicie 
**### systemctl mask cups.service-**
- Al final puedes revisar el status del servicio usando el comando 
**### systemctl status cups.service**
- Y esto te mostrará el estado actual del servicio:

![[436.B7E2_estado_actual.png]]

##### Instala solo el software que realmente necesitas
Instalar software en GNU/Linux es muy sencillo, basta con usar los manejadores de paquetes para hacerlo. 

- Por ejemplo, instalar en Debian/Ubuntu, un programa como Audacity (para edición de audio) es tan sencillo como ejecutar el comando:
**### sudo apt install audacity**

Con eso inicia la descarga del software desde los repositorios (un servidor donde se encuentra disponible todo el software compatible con la distribución) y la instalación se realiza de forma automática. Asimismo, desinstalar software es igual de sencillo y la recomendación es desinstalar todo aquello que no necesitas. De esta manera, estarás reduciendo la superficie de ataque que puede haber sobre el sistema, ya que hay menos código y software ejecutándose sobre el computador, lo que reduce las posibilidades vulneración del sistema. 

- Para desinstalar solo debes usar el comando:
**### sudo apt purge audacity **

##### Uso de herramientas de Hardening en GNU/Linux
Una de las herramientas básicas para el Hardening de sistemas GNU/Linux es Lynis. 

Tanto su versión comunitaria como su versión empresarial, permiten ajustar la seguridad de estos sistemas a buenos niveles. De hecho, Lynis Enterprise es capaz de asegurar sistemas para cumplir con los estándares de seguridad PCI DSS, HIPPA, ISO 127001 e ISO 127002, lo que nos permite mantener los sistemas empresariales debidamente protegidos. 

Por supuesto, hay muchas más opciones de seguridad, sobre todo si se usan servicios como Docker o LXC (sistemas de contenedores), en los que la seguridad de los sistemas se amplifica y que necesitan de un estudio más personal de cada servicio que se instale usando este tipo de sistemas. 

En todo caso, cada uno de esos servicios pueden asegurarse usando las baselines y STIGS que se han visto en los módulos anteriores. Por ejemplo, puedes usar un STIG de Apache y Docker, para asegurar Docker y el servicio Apache que se instale dentro el mismo, de esta manera serás capaz de agregar un mayor nivel de seguridad a tu infraestructura Docker.


### 437.B7E2.5_Hardening-Casos_de_uso

### Casos de uso de Hardening en el mundo cripto
El Hardening es especialmente útil en el mundo cripto, especialmente, cuando se tiene en cuenta el diseño de sistemas de hardware y software seguro desde sus inicios.

En ese sentido, podemos decir que el Hardening tiene espacios dentro de:
1. **Realización de software y hardware seguro,** usando los mayores estándares de seguridad (ej: Common Criteria) a nivel de criptografía, diseño de software y hardware, generación y manejo de proyectos, entre otros. 
2. **Permitir la instalación y despliegue de servicios públicos y privados de criptomonedas** (exchanges, exploradores, entre otros) que sean seguros de usar y resilientes a los ataques que puedan perpetrarse en su contra.
3. **Ofrecer a los usuarios mejores garantías de que sus tokens y criptomonedas se encuentran seguros dentro de los servicios, hardware y software ofrecido por las empresas del sector.** La transmisión de confianza y seguridad de los servicios ofrecidos permite a las empresas generar una mejor imagen profesional en el sector.


